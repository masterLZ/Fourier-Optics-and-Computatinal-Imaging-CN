%
%导言区，用于配置格式
%指定编译器是xelatex
%!TEX program=xelatex 
\documentclass[12pt, UTF8]{ctexart}%指明文档是中文
\usepackage{hyperref}%导入包
\usepackage{graphicx}%导入图片包
\usepackage[a4paper]{geometry}%定义大小
%改变字体背景颜色需要color和framed宏包
\usepackage{framed}
\usepackage{color}% 导入颜色
%\usepackage{underscore}%取消下划线识别 这个包去掉，要不文件名不能有下划线
\usepackage[normalem]{ulem} 
\usepackage{amsmath}%加入对齐包
\definecolor{shadecolor}{rgb}{0.92,0.92,0.92}
%公式、图片随章节改变
\usepackage{amsmath}
\numberwithin{equation}{section}
\numberwithin{figure}{section}
%自定义函数
\def\CodingInline#1{\colorbox{shadecolor}{\color{black}#1}}%内联代码
\newcommand {\InsertPic}[3]{\begin{figure}[htbp]\centering \includegraphics[width=0.8\textwidth]{D:/学习文档/傅里叶光学/翻译/tu/Fourier-Optics-and-Computational-Khare_img_#1.jpg}\caption{#3}  \label{#2}\end{figure}}%插入图片
\def\CodingBlock#1{\begin{shaded} \noindent#1 \end{shaded}}
\def\Emphasize#1{\textcolor[rgb]{1,0,0}{#1}}
\newcommand{\InsertEqution}[2]{\begin{equation}
  \label{#1}
   #2
 \end{equation}}
\newcommand{\RefEq}[1]{Eq.\ref{#1}}
\newcommand{\InsertInlineEq}[1]{$#1$}
\newcommand{\RefFig}[1]{图 \ref{#1}}
\newcommand{\InsertItem}[1]{\begin{enumerate} #1 \end{enumerate}}

%正文区
%begin end 用于指定环境
\begin{document}
  \begin{sloppypar}
     %配置开头
     \title{傅里叶光学和计算成像翻译}
     \author{Dr. Li}
     \date{2020年5月3日}
     \maketitle

     %摘要
    \begin{abstract}
        用于翻译Fourier Optics and Computatinal Imaging, 目前自用
        \begin{figure}[htbp]%h当前位置，t顶部，b底部，p浮动
            \centering
            \includegraphics[width=1\textwidth]{D:/MyCoding/ElectronicComics/comics4.png}
            % \caption{LOGO}
        \end{figure} 
    \end{abstract}
    \newpage

    
    \section{采样定理}
    我们经常听到或谈论今天在我们周围看到的数字革命。由于我们每天使用的数字设备，我们的生活在一代人的时间内发生了巨大变化。为了使像手机这样的小工具成为可能，必须开发和整合许多技术。但是为什么我们经常建模为连续函数的信号的数字表示之所以可能的核心思想在于采样定理。在讨论这个之前，我要指出，通过电磁手段进行的通信在20世纪初很实用。那时，量化传达某些特定信息所需的资源的问题变得很重要。克劳德·香农（Claude Shannon）为开发形式主义以量化信息以进行交流而功劳。他关于该主题的标题为“通信的数学理论”（Bell Systems Tech. Journal
    1948）的文章是经典著作。正如我之前已经讨论过的，在成像或相关现象中我们感兴趣的信息被编码在波中将信息从对象传送到我们系统上。尽管我们的大多数波动现象模型都是连续的，但任何测量所需的采样都是在离散点进行的。采样多少是合适的？从直觉上看，抽取的样本越多越好。 但是，也很明显，如果您想对语音信号进行采样，那么当感兴趣的最高音频频率最多为几kHz时，以1MHz或1GHz的速率进行采样可能会太多。 我们可以以某种方式将这种直觉形式化吗？我们可以确定所需采样率的界限吗？ 我们将在本章中研究这个重要的基本问题。 采样思想在计算成像系统中起着重要作用。图像的离散点通常被表示为图像的像素点。
    
   \subsection{泊松求和方程}
   我们将通过对泊松求和方程的傅里叶变换得出采样定理。有了泊松方程我们就不难获得采样定理。只是在交流信息中这个结果才有意义。我们首先考虑一个信号$g(x)$和对应的傅里叶变换
   \InsertEqution{3.1}{G\left(f_{x}\right)=\int_{-\infty}^{\infty} d x g(x) \exp \left(-i 2 \pi f_{x} x\right)}
  首先我们使用$G(f_x)$构造一个周期为$\Delta$的周期函数，然后表示为一个傅里叶序列\InsertEqution{3.2}{\sum_{n=-\infty}^{\infty} G\left(f_{x}+n \Delta\right)=\sum_{k=-\infty}^{\infty} g_{k} \exp \left(-i 2 \pi k f_{x} / \Delta\right)}
  利用周期函数的傅里叶逆变换可获得\RefEq{3.2}系数$g_k$。\InsertEqution{3.3}{\begin{aligned}
g_{k} &=\frac{1}{\Delta} \int_{-\Delta / 2}^{\Delta / 2} d f_{x} \sum_{n=-\infty} G\left(f_{x}+n \Delta\right) \exp \left(i 2 \pi k f_{x} / \Delta\right) \\
&=\frac{1}{\Delta} \sum_{n=-\infty}^{\infty} \int_{\left(n-\frac{1}{2}\right) \Delta}^{\left(n+\frac{1}{2}\right) \Delta} d u G(u) \exp (i 2 \pi k u / \Delta-i 2 \pi n k)
\end{aligned}}
因为\InsertInlineEq{n,k}是整数，我们可以知道\InsertInlineEq{\exp (-i 2 \pi n k)=1}。此外因为\InsertInlineEq{n:-\infty\rightarrow\infty},有效的覆盖了整个\InsertInlineEq{u},因此周期项可以忽略，\RefEq{3.3}可以写成\InsertEqution{3.4}{\begin{aligned}
  g_{k} &=\frac{1}{\Delta} \int_{-\infty}^{\infty} d u G(u) \exp (i 2 \pi k u / \Delta) \\
  &=\frac{1}{\Delta} g\left(\frac{k}{\Delta}\right)
  \end{aligned}}
从以上结果可以知道，通过对\InsertInlineEq{G(f_x)}添加规则的移位形成的周期函数，相应的傅立叶级数系数​​只是点\InsertInlineEq{x=k/\Delta}处函数\InsertInlineEq{g(x)}的周期采样,\InsertInlineEq{k}为整数。
\subsection{特殊情况下的采样定理}
为了建立采样定理，我们将定义带限信号。如果信号\InsertInlineEq{g(x)}的傅里叶变换在\InsertInlineEq{f_{x}:(-B, B)}外消失，我们就称这个信号是带限信号。现在我们将考虑当信号\InsertInlineEq{g(x)}受到上述带宽限制且\InsertInlineEq{\Delta = 2B}时的泊松求和公式的特例。 现在，傅立叶变换的移位版本不重叠，我们可以在方程\RefEq{3.2}两边相乘一个矩形函数来滤除\InsertInlineEq{n=0}项:\InsertEqution{3.5}{G\left(f_{x}\right)=\frac{1}{2 B} \sum_{k=-\infty}^{\infty} g\left(\frac{k}{2 B}\right) \exp \left(-i 2 \pi k \frac{f_{x}}{2 B}\right) \operatorname{rect}\left(\frac{f_{x}}{2 B}\right)}
对齐进行逆傅里叶变换可以得到\InsertEqution{3.6}{\begin{aligned}
  g(x) &=\frac{1}{2 B} \sum_{k=-\infty}^{\infty} g\left(\frac{k}{2 B}\right) \int_{-\infty}^{\infty} d f_{x} \exp \left[i 2 \pi f_{x}\left(x-\frac{k}{2 B}\right)\right] \operatorname{rect}\left(\frac{f_{x}}{2 B}\right) \\
  &=\sum_{k=-\infty}^{\infty} g\left(\frac{k}{2 B}\right) \operatorname{sinc}\left[2 B\left(x-\frac{k}{2 B}\right)\right]
\end{aligned}}
它告诉我们，以\InsertInlineEq{1/2B}分开的离散点处的带限信号\InsertInlineEq{g(x)}的样本包含与连续信号相同的信息。 如果我们知道这些离散的样本值，则可以\CodingInline{通过对样本进行正弦插值}来重建连续信号。这个采样率被称为奈奎斯特率。
\subsection{采样公式的其他说明}
关于采样定理，需要注意的比较重要的一点是，移动的sinc函数集合构成了一组正交完备基。这与其他集合不同（如Hermite-Gauss函数），这里是统一个函数不同的移动版本是正交的。这种不寻常的基可以追溯到小波等不寻常基的起源。\\
这个集合的正交性的证明如下：\InsertEqution{3.7}{\begin{aligned}
  &\int_{-\infty}^{\infty} d x \operatorname{sinc}(2 B x-m) \operatorname{sinc}(2 B x-n) \\
  &\quad=\left.\mathcal{F}^{-1}\left\{\frac{1}{(2 B)^{2}} \operatorname{rect}^{2}\left(\frac{f_{x}}{2 B}\right)\right\}\right|_{x=\frac{m-n}{2 B}} \\
  &\quad=\frac{1}{2 B} \operatorname{sinc}(m-n) \\
  &\quad=\frac{1}{2 B} \delta_{m, n}
  \end{aligned}
  }
  在计算中，我们使用的卷积定理。带限信号\InsertInlineEq{g(\frac{m}{2B})}可以看成sinc基下的相关系数，即\InsertEqution{3.8}{g\left(\frac{m}{2 B}\right)=\frac{1}{2 B} \int_{-\infty}^{\infty} d x g(x) \operatorname{sinc}(2 B x-m)}
sinc基集合的完备性可以很简单的证明，观察到：\InsertEqution{3.9}{\sum_{n=-\infty}^{\infty} \operatorname{sinc}(2 B x-m) \operatorname{sinc}\left(2 B x^{\prime}-m\right)=\operatorname{sinc}\left[2 B\left(x-x^{\prime}\right)\right]}
使用采样定理应用于sinc函数本身。对于每一个带限信号\InsertInlineEq{g(x)},带宽\InsertInlineEq{f_{x}:(-B, B)},我们有\InsertEqution{3.10}{\begin{aligned}
  \int_{-\infty}^{\infty} d x^{\prime} g\left(x^{\prime}\right) \operatorname{sinc}\left[2 B\left(x-x^{\prime}\right)\right] &=\mathcal{F}^{-1}\left[G\left(f_{x}\right) \frac{1}{2 B} \operatorname{rect}\left(\frac{f_{x}}{2 B}\right)\right] \\
  &=\frac{1}{2 B} g(x)
  \end{aligned}}
  如果现在将完整性关系用于\InsertInlineEq{sinc[2B(x-x')]}和\RefEq{3.8}的关系，就得出了采样定理。因此，sinc基可以表示每个带限函数，可以将表达式\InsertInlineEq{sinc[2B(x-x')]}视为\InsertInlineEq{\delta(x-x')}的带限版本。
  \subsection{对载频信号的采样}
  有时通过陈述僵化的规则来简单地解释香农采样定理具有误导性，即正弦信号每个正弦周期需要两个采样。 因为如果知道我们采样的是正弦曲线，那么仅应从知道其频率，幅度和初始相位的角度就可以确定波形。 实际上，在通信中遇到的一类重要信号，窄带光场表示和光学干涉成像等形式的情况下，也会出现类似情况。这种情况可以表示为：\InsertEqution{3.11}{g(x)=a(x) \exp \left(i 2 \pi f_{0} x\right)+a^{*}(x) \exp \left(-i 2 \pi f_{0} x\right)}。这里\InsertInlineEq{a(x)}是信号的复振幅包络，\InsertInlineEq{f_0}是载频。此类信号在大多数情况下，包络\InsertInlineEq{a(x)}的有效带宽\InsertInlineEq{2B}是远小于载频\InsertInlineEq{f_0}的，典型的载频信号的傅里叶幅度如图\InsertPic{13}{F3.1}{\InsertInlineEq{\left|G(f_x)\right|}的傅里叶频谱强度}。因此包络的有效带宽和载频的比值\InsertEqution{3.12}{\frac{f_{0}}{2 B} \geq \frac{f_{0}}{2 B_{0}}=N+\frac{1}{2}},对于一些给定的整数\InsertInlineEq{N}(可能是最大值对于确定的\InsertInlineEq{f_0,B}),\footnote{这里意思是说对于给定的\InsertInlineEq{B},总可以找到一个稍微大一些的值\InsertInlineEq{B_0},使其满足\InsertInlineEq{f_0}是\InsertInlineEq{N+\frac{1}{2}}倍的\InsertInlineEq{B_0},这样\InsertInlineEq{N}可以使用sinc函数的频移来表示，剩下来的\InsertInlineEq{\frac{1}{2}}就是一个2倍于\InsertInlineEq{2B_0}的信号，可以用\InsertInlineEq{1/4B_0}的间隔去采样。}
  这样信号\InsertInlineEq{g(x)}就可以用\InsertInlineEq{1/(4B_0)}的采样间隔来获得采样定理下的信号形式：\InsertEqution{3.13}{g(x)=\sum_{k=-\infty}^{\infty} g\left(\frac{k}{4 B_{0}}\right) \operatorname{sinc}\left[2 B_{0}\left(x-\frac{k}{4 B_{0}}\right)\right] \cos \left[2 \pi f_{0}\left(x-\frac{k}{4 B_{0}}\right)\right]}
  也可以使用低通采样定理类似的论据得出上述结果，并且有时将其称为带通采样定理。 此结果的中心思想是有效利用以下事实：即使采样间隔比\InsertInlineEq{1/2(f_0+B)}大得多，傅里叶空间中的空白区域也不会导致混叠。上式中的余弦项可以表示为两个指数项的总和，而解调后的包络\InsertInlineEq{a(x)}可以表示为一个采样序列：\InsertEqution{3.14}{a(x)=\sum_{k=-\infty}^{\infty} g\left(\frac{k}{4 B_{0}}\right) \operatorname{sinc}\left[2 B_{0}\left(x-\frac{k}{4 B_{0}}\right)\right] \exp \left(-2 \pi f_{0} \frac{k}{4 B_{0}}\right)}
  因此，采样率与复杂包络中的波动相当，而不是最大信号带宽。在以上讨论中暗含了对载波频率\InsertInlineEq{f_0}的了解。正如我们将在下一节中讨论的那样，此结果对于量化信号的自由度非常重要。
  \subsection{信号的自由度：空间带宽积}
  假设我们有一个长度为2L的信号要存储或传输给其他人，需要多少空间？大多数实际信号或图像都是有限范围的，并且严格意义上来讲不能有限长的信号不能同时是带限的。它的傅里叶变换原则上必须在整个频率轴上扩展。因此，带宽的概念需要仔细定义。对于长度在\InsertInlineEq{x:(-L,L)}的信号\InsertInlineEq{g(x)},我们在频率段\InsertInlineEq{f_x:(-B,B)}定义能量集中比\InsertInlineEq{\alpha}为\InsertEqution{3.15}{\alpha=\frac{\int_{-B}^{B} d f_{x}\left|G\left(f_{x}\right)\right|^{2}}{\int_{-\infty}^{\infty} d f_{x}\left|G\left(f_{x}\right)\right|^{2}}}。
对于带宽的实用的定义为在频率段\InsertInlineEq{fx:(-B,B)}内，能量集中比接近于实际应用要求的1（比如0.999）。需要多少个信号样本才能以相当准确的方式表示它？ 答案是\InsertInlineEq{2B\times2L}。\InsertInlineEq{N=4BL}的乘积称为空间带宽积，他表示信号的自由度。对于2D信号或者图像这个数是\InsertInlineEq{N^2},即表示图形所需的像素数。

信号和系统的空间带宽积是两个不同的概念。假设我们的对象是放置在玻片内的生物组织样本，需要在显微镜下观察。活细胞是一个非常复杂的对象，感兴趣的细节可以在分子或者纳米尺度上对应于空间频率的数量级是\InsertInlineEq{10^{9}m^{-1}},则对于一个\InsertInlineEq{1mm\times1mm}物体，空间带宽积为为\InsertInlineEq{(10^-3)^2\times(10^9)^2=10^12}。而观测细胞的系统可以具有小的多的空间带宽积。用于可见光的显微镜的分辨率可能只有\InsertInlineEq{1\mu m}，因此该显微系统的空间带宽积是\InsertInlineEq{(10^-3)^2\times(10^6)^2=10^6}。因此，如果要将CCD相机作为探测器放置在显微镜的后端，则\InsertInlineEq{1000\times1000}像素的传感器芯片就足够了。如果我们在弱光条件下运行，则噪声会使来自每个像素的信号有些不可靠。我们可能需要对传感器芯片进行binning，以便对一个\InsertInlineEq{2\times2}像素块进行平均。因此，生成的图像是\InsertInlineEq{500\times500}像素,减少了可以从系统设置程序中检索到的信息。因此，空间带宽乘积既取决于系统参数，又取决于信噪比。\footnote{这里不太正确，应该是空间带宽积还是这么多，但是信号的置信度下降了，导致可以直接获得的真实信息的量减少了，这种是可以通过其他方法恢复的。}
\subsection{Slepian(椭球形)函数}
我们在\RefEq{3.15}中定义了能量集中率，以便对带宽做出实际定义。\InsertInlineEq{\alpha}的最大值问题由香农在1950年提出。Slepian，Pollak和Landau在Bell System Tech的一系列论文中对该问题进行了全面分析。 为了纪念D.Slepianz这类函数被称为Slepianz函数。我们会讨论这些函数一些有趣的性质，然后建立起和采样定理的关联。当我们讨论诸如超分辨或者成像系统的信息承载呢能力是，Slepian函数将会比较有用。

对于一个在\InsertInlineEq{x:(-L,L)}上的函数\InsertInlineEq{g(x)},我们可以利用傅里叶变换将能量集中率\InsertInlineEq{\alpha}表示为：\InsertEqution{3.16}{\alpha=\frac{\int_{-B}^{B} d f_{x}\left|G\left(f_{x}\right)\right|^{2}}{\int_{-\infty}^{\infty} d f_{x}\left|G\left(f_{x}\right)\right|^{2}}}
我们观察到上述\InsertInlineEq{\alpha}的展开是sinc核的Rayleigh-Ritz系数，则\InsertInlineEq{\alpha}的最大值可以由\InsertInlineEq{(2B\lambda_0)}获得,\InsertInlineEq{\lambda_0}是以下特征方程的特征值。\InsertEqution{3.17}{\lambda \phi(x)=\int_{-L}^{L} d x^{\prime} \operatorname{sinc}\left[2 B\left(x-x^{\prime}\right)\right] \phi\left(x^{\prime}\right)}通常prolate基函数会按照相应特征值的大小降序排列。对于给定的\InsertInlineEq{L,B}, 最大的\InsertInlineEq{N}个特征方程可以在能量集中的意义上认为是最佳的基。Slepian和他的同事在早期工作中认识到，sinc-kernel的本征函数是在方程\InsertInlineEq{\chi(c)}的离散正值的条件下，椭球面微分方程的角部分的解：\InsertEqution{3.18}{\left(L^{2}-x^{2}\right) \frac{d^{2} \phi}{d x^{2}}-2 x \frac{d \phi}{d x}+\left(\chi-\frac{c^{2} x^{2}}{L^{2}}\right)=0}。参数\InsertInlineEq{c=2\pi LB}被称为香农数，与空间带宽积有关。关于Slepian函数的大多数文献都是基于微分方程\RefEq{3.18}的解及其根据\InsertInlineEq{c}值的渐近解来研究其性质的。我们将基于采样定理采用不同的方法。基于微分方程解的讨论在某种程度上是临时的，与诸如采样定理固有相关的空间带宽积之类的思想没有简单的联系。

我们注意到\RefEq{3.17}中的特征值是第二类其次Fredholm积分方程，该方程的核是厄米对称且平方可积的。此外这个核还是正定的：\InsertEqution{3.19}{
  \int_{-L}^{L} \int_{-L}^{L} d x d x^{\prime} \operatorname{sinc}\left[2 B\left(x-x^{\prime}\right)\right] g(x) g^{*}\left(x^{\prime}\right) \\
  \quad=\frac{1}{2 B} \int_{-B}^{B} d f_{x}\left|G\left(f_{x}\right)\right|^{2} \\
  \quad \geq 0
  }
  对于任意平方可积函数\InsertInlineEq{g(x)}。当\InsertInlineEq{g(x)}等于零时，\RefEq{3.19}的等号成立，因此，sinc核的特征值为正。我们将首先表明，sinc核的本征函数满足采样定理，因此受到带宽限制。我们已经注意到，sinc内核本身是有带宽限制的，因此具有以下采样扩展：
  \InsertEqution{3.20}{\operatorname{sinc}\left[2 B\left(x-x^{\prime}\right)\right]=\sum_{m=-\infty}^{\infty} \operatorname{sinc}(2 B x-m) \operatorname{sinc}\left(2 B x^{\prime}-m\right)}。对\RefEq{3.17}使用sinc核展开可以得到：\InsertEqution{3.21}{\begin{aligned}
    \lambda \phi(x) &=\int_{-L}^{L} d x^{\prime} \sum_{m=-\infty}^{\infty} \operatorname{sinc}(2 B x-m) \operatorname{sinc}\left(2 B x^{\prime}-m\right) \phi\left(x^{\prime}\right) \\
    &=\sum_{m=-\infty}^{\infty}\operatorname{sinc}(2 B x-m)\times(\int_{-L}^{L} d x^{\prime} \operatorname{sinc}\left(2 B x^{\prime}-m\right) \phi\left(x^{\prime}\right))
    \\&=\lambda \sum_{m=-\infty}^{\infty} \phi\left(\frac{m}{2 B}\right) \operatorname{sinc}(2 B x-m)
    \end{aligned}}
  所以\RefEq{3.17}可以写成\InsertEqution{3.22}{\begin{aligned}
    \lambda \phi\left(\frac{m}{2 B}\right) &=\int_{-L}^{L} d x^{\prime} \operatorname{sinc}\left(2 B x^{\prime}-m\right) \phi\left(x^{\prime}\right) \\
    &=\int_{-L}^{L} d x^{\prime} \operatorname{sinc}\left(2 B x^{\prime}-m\right) \sum_{n=-\infty}^{\infty} \phi\left(\frac{n}{2 B}\right) \operatorname{sinc}\left(2 B x^{\prime}-n\right) \\
    &=\sum_{n=-\infty}^{\infty} A_{m n}^{(0)} \phi\left(\frac{n}{2 B}\right)
    \end{aligned}}
  其中矩阵\InsertInlineEq{A^{(0)}}的元素可以定义为：\InsertEqution{3.23}{A_{m n}^{(0)}=\int_{-L}^{L} d x^{\prime} \operatorname{sinc}\left(2 B x^{\prime}-m\right) \operatorname{sinc}\left(2 B x^{\prime}-n\right)}
可以发现，sinc核的连续特征值问题因此等效于矩阵\InsertInlineEq{A^{(0)}}的离散特征值问题。\footnote{\InsertInlineEq{\lambda\phi\left(\frac{n}{2B}\right)=A^{(0)}_{mn}\phi(\frac{n}{2B})}}
连续和离散问题共享相同的特征值 此外，矩阵\InsertInlineEq{A^{(0)}}的特征向量与连续椭球状函数的Nyquist样本相同。 因此，可以通过对离散特征向量进行正弦插值来获得连续函数。
\subsubsection{\InsertInlineEq{A^{(0)}}的性质}
为了简洁起见，我们将矩阵\InsertInlineEq{A^{(0)}}的离散特征向量表示为
\InsertEqution{?1}{u_{n}=\left[\ldots \phi_{n}\left(\frac{m}{2 B}\right) \ldots\right]^{T}},符号T是行向量的转置。\InsertInlineEq{A^{(0)}}是实对称的所以他的特征值和特征向量是实数。我们将连续函数\InsertInlineEq{\phi_n(x)}归一化为\InsertInlineEq{x:(-\infty,\infty)},可以写成:\InsertEqution{3.24}{\int_{-\infty}^{\infty} d x \phi_{n}^{2}(x)=1 = \frac{1}{2 B} \sum_{m=-\infty}^{\infty} \phi_{n}^{2}\left(\frac{m}{2 B}\right)}。\RefEq{3.24}来自以下事实，\InsertInlineEq{\phi_n(x)}根据\RefEq{3.21}扩展采样，进一步使用了sinc函数的正交性\RefEq{3.7}。\InsertInlineEq{A^{(0)}}是关于元素\InsertInlineEq{A^{(0)}_{00}}是对称的。众所周知，此类矩阵的特征向量具有确定的奇偶性-它们是偶数或奇数。因此，通过离散特征向量的正插值获得的连续特征函数也具有一定的奇偶性。

矩阵\InsertInlineEq{A^{(0)}}可以被分解为\InsertEqution{3.25}{A^{(0)}=U A_{d}^{(0)} U^{T}}。其中\InsertInlineEq{A^{(0)_d}}是对角矩阵，特征值\InsertInlineEq{\lambda_n}分布在对角线上，矩阵\InsertInlineEq{U}具有特征向量\InsertInlineEq{u_n}。此外特征向量是正交的:\InsertEqution{3.26}{U^{T} U=2 B \hat{\mathbf{1}}=U U^{T}}利用这些恒等式\InsertInlineEq{\phi_n(\frac{m}{2B})}可以显式地获得以下关系：正交性\InsertEqution{3.27}{\sum_{m=-\infty}^{\infty} \phi_{n}\left(\frac{m}{2 B}\right) \phi_{l}\left(\frac{m}{2 B}\right)=2 B \delta_{n l}}完备性\footnote{完备性表示可以用这个基表示整个空间}\InsertEqution{3.28}{\sum_{n=0}^{\infty} \phi_{n}\left(\frac{m}{2 B}\right) \phi_{n}\left(\frac{k}{2 B}\right)=2 B \delta_{m k}}
矩阵\InsertInlineEq{A^{(0)}}的结构非常有趣由于矩阵元素被定义为移位正弦函数乘积上的定积分，因此只有大约\InsertInlineEq{(2B)(2L)}个矩阵元素沿着以矩阵元素为\InsertInlineEq{A^{(0)}_{00}}中心的矩阵对角线是有效的。这解释了sinc核的一个众所周知的性质，即问题的最高特征值只有大约\InsertInlineEq{4BL}是显著的。这对于使用prolate函数的信号表示有着有趣的含义。\InsertPic{14}{F3.2}{\InsertInlineEq{L=1,B=5/\pi}时，使用基于采样定理的方法计算的前8个prolate函数}\InsertPic{15}{F3.3}{\InsertInlineEq{L=1,B=5/\pi}时，sinc核函数的前10个特征值}
在\RefFig{F3.2}和\RefFig{F3.3}中我们展示了使用基于采样定理的方法分别计算prolate函数及其对应的特征值\footnote{求矩阵\InsertInlineEq{A_{mn}^{(0)}的特征值和特征向量，每个特征向量插值后就是prolate函数}}。使用以元素\InsertInlineEq{A^{(0)}_{00}}为中心的矩阵\InsertInlineEq{A^{(0)}}的\InsertInlineEq{101\times101}近似值，并根据\RefEq{3.23}中的定义使用标准数值积分方法计算矩阵元素。然后，对由此获得的离散特征向量进行内插，以获得连续的特征函数。 总的来说，我们观察到第n个长函数在间隔\InsertInlineEq{x:(-L,L)}中有n个过0点。对于\InsertInlineEq{n>4BL}阶的函数，这似乎是违反直觉的，其中零交叉点的数量超过了空间带宽积，尽管相应的长函数仍在无限间隔内被带宽限制。与空间带宽乘积相比，这样的函数在有限的时间间隔内具有更多的零交叉，实际上被称为“超振荡”。我们进一步注意到，当索引n超过\InsertInlineEq{4BL}时，相应的函数函数中的大多数能量都集中在间隔\InsertInlineEq{x:(-L,L)}之外。

我们将陈述prolate函数\footnote{\InsertInlineEq{\phi_n(x)}}的一些有趣特性，这些特性可以很容易地从\RefEq{3.27}和\RefEq{3.28}中的离散正交性和完整性关系中得出。
\InsertItem{\item 对偶正交性:曲线函数在\InsertInlineEq{-\infty,\infty}以及正交域\InsertInlineEq{x:(-L,L)}用于定义\InsertEqution{3.29}{\int_{-\infty}^{\infty} d x \phi_{n}(x) \phi_{m}(x)=\delta_{m, n}}
\InsertEqution{3.30}{\int_{-L}^{L}d x \phi_{n}(x) | \phi_{m}(x)=\left(2 B \lambda_{n}\right) \delta_{m, n}}
如果使用\InsertInlineEq{\phi_n(x)}和\InsertInlineEq{\phi_m(x)}的采样扩展，然后按照\RefEq{3.27}，则第一个恒等式很容易证明。\RefEq{3.30}的有限区间的第二正交性可以证明如下：\InsertEqution{3.31}{\begin{aligned}
  &\int_{-L}^{L} d x \phi_{n}(x) \phi_{m}(x) \\
  &=\sum\limits_{k=-\infty}^{\infty} f_{n}\left(\frac{k}{2 B}\right) \int_{-L}^{L} d x \operatorname{sinc}(2 B x-k) \phi_{m}(x) \\
  &=\lambda_{m} \sum\limits_{k=-\infty}^{\infty} \phi_{n}\left(\frac{k}{2 B}\right) \phi_{m}\left(\frac{k}{2 B}\right) \\
 & =2 B \lambda_{m} \delta_{m, n}
  \end{aligned}}
  \item 完备性：Prolate函数在函数带宽限制为\InsertInlineEq{f_x:(-B,B)}的情况下在\InsertInlineEq{-\infty,\infty}上具有正交基础，而在\InsertInlineEq{x:(-L,L)}中的平方可积函数具有完整的正交基础。}


  在考虑带限外推之类的问题时，我们将使用正交性和完整性属性。通常，在本书的整个讨论中，当讨论成像系统的信息传输功能时，我们将有各种场合引用Prolate函数。我们注意到，基于采样定理的曲线函数的方法通常同样适用于与带限核相关的特征值问题，并且在一般情况下，可以证明与Prolate椭球体类似的一些有趣的数学关系。
  \subsection{带限函数外推}
  Prolate椭球面函数的双重正交性和完整性属性可用于外推截短区域内已知的带限函数。假设在有限范围\InsertInlineEq{x:(-L,L)}内已知一个限制在频带\InsertInlineEq{f_x:(-B,B)}上的函数\InsertInlineEq{g(x)}，则可以使用如下设置的椭球函数扩展它：\InsertEqution{3.32}{g(x)=\sum_{n} a_{n} \phi_{n}(x)},其中可以使用区域\InsertInlineEq{x:(-L,L)}上的Prolate函数的正交性确定系数：\InsertEqution{3.33}{a_{n}=\frac{1}{2 B \lambda_{n}} \int_{-L}^{L} d x g(x) \phi_{n}(x)}
  另外，原则上可以通过使用相同的系数\InsertInlineEq{a_n}将函数扩展到范围\InsertInlineEq{x:(-L,L)}之外。 但是，确定函数超出范围\InsertInlineEq{x:(-L,L)}的可能性实际上取决于我们对\InsertInlineEq{g(x)}的有限范围知识的准确性。例如，如果\InsertInlineEq{g(x)}的值是通过一些实验测量确定的，则它们将包含一些噪声，这些噪声会转换为系数\InsertInlineEq{a_n}的噪声。在\RefEq{3.33}中，系数\InsertInlineEq{a_n}的获得涉及除以相应的特征值\InsertInlineEq{\lambda_n}。正如我们在上面已经看到的，当索引\InsertInlineEq{n>>4 B L}和相应的函数函数的大部分能量集中在\InsertInlineEq{x:(-L,L)}范围之外时，特征值通常很小。因此，尽管这样的高阶曲线函数能够在已知函数\InsertInlineEq{g(x)}的有限范围内重建信号，但将它们包含在级数表示中会涉及将相应系数\InsertInlineEq{a_n}除以非常小的特征值。 由于系数\InsertInlineEq{a_n}是有噪声的，因此用小数除法会放大噪声，从而使序列表示毫无意义。避免噪声放大的一种简单方法是将序列表示截断为有限数量的项，然后有效地构成超出\InsertInlineEq{(-L,L)}的有限范围的外推。外推的问题严重的依赖于对\InsertInlineEq{g(x)}测量的SNR。 通常可以使用Slepian函数根据外推法来制定数字超分辨率成像技术。

  在结束本章讨论时，我们注意到通过sinc集合或Slepian函数基础进行的采样彼此等效。诸如小波之类的相关领域中重要发展的起源可以追溯到本章所涵盖的内容。
\section{快速傅立叶变换介绍}
\subsection{定义}
本书将不时遇到傅立叶变换，对于学生和从业人员来说，重要的是要对数值例程或函数具有基本的操作性理解，这些数字例程或函数可用于对离散采样的信号和图像实施傅立叶变换。 本章决不讨论离散傅立叶变换和快速傅立叶变换算法的详细信息，对于这些算法，已有很好的文献资料。此处的目的是提供足够的信息，以便在将标准计算工具或库用于FFT操作时，用户可以理解结果。 沿途还指出了有关使用2D傅里叶变换函数模拟光学成像系统的一些重要方面。

通过对第三章中所讨论的采样思想的介绍，我们现在可以用采样来在空间带宽积\InsertInlineEq{N\approx4BL}表示长度超过\InsertInlineEq{2L}有效带宽超过\InsertInlineEq{2B}的信号\InsertInlineEq{g(0/2B),g(1/2B),...,g((N-1)/2B)}。离散的傅里叶变换可以被定义为：\InsertEqution{4.1}{G\left(\frac{m}{2 L}\right)=\sum_{n=0}^{N-1} g\left(\frac{n}{2 B}\right) \exp (-i 2 \pi m n / N)}
相应的傅里叶逆变换可以被定义为\InsertEqution{4.2}{g\left(\frac{n}{2 B}\right)=\frac{1}{N} \sum_{m=0}^{N-1} G\left(\frac{m}{2 L}\right) \exp (i 2 \pi m n / N)}
我们注意到，当信号仅通过离散样本集定义在\InsertInlineEq{x:(-L,L)}上时，上述离散傅里叶变换操作近似于傅里叶变换的连续积分形式。空域样本的周期为\InsertInlineEq{1/(2B)}，而频域周期为\InsertInlineEq{1/(2L)}。在大多数情况下，通常会省略\InsertInlineEq{2B,2L},但在这里我们保留这个参数。可以观察到正向和反向DFT是线性变换，可以以矩阵形式编写。 例如使用符号\InsertEqution{4.3}{\omega=\exp (i 2 \pi / N)},对于N个以1为开始的变换\RefEq{4.1}可以写成\InsertEqution{4.4}{\mathbf{G}=\mathbf{F} \mathbf{g}}或者\InsertEqution{4.5}{\left(\begin{array}{c}
  G\left(\frac{0}{2 L}\right) \\
  G\left(\frac{1}{2 L}\right) \\
  \cdot \\
  \cdot \\
  G\left(\frac{N-1}{2 L}\right)
  \end{array}\right)=\left(\begin{array}{cccc}
  1 & 1 & \cdots & 1 \\
  1 & \omega^{-1} & \cdots & \omega^{N-1} \\
  \cdot & \cdot & \cdots & \cdot \\
  \cdot & \cdot & \cdots & \cdot \\
  & \cdot & \cdots & \cdot \\
  1 & \omega^{-(N-1)} & \cdots & \omega^{-(N-1)^{2}}
  \end{array}\right)\left(\begin{array}{c}
  g\left(\frac{0}{2 \beta}\right) \\
  g\left(\frac{1}{2 B}\right) \\
  \cdot \\
  \cdot \\
  g\left(\frac{N-1}{2 B}\right)
  \end{array}\right)}
我们可以注意到\InsertInlineEq{\omega}满足\InsertEqution{4.6}{\omega^{(N-m)}=\omega^{-m}}
结果，频率\InsertInlineEq{0/(2L),1/(2L),...,(N-1))/(2L)}形成离散傅立叶变换\InsertInlineEq{G}的自变量可以被重新排序为正和负频率。用于定义正和负频率的典型约定如下：
\InsertItem{\item \InsertInlineEq{N}为基数：\InsertInlineEq{\nu = 0/(2L)}是零频率或dc项，\InsertInlineEq{\nu=1/(2L)}到\InsertInlineEq{\nu=(N/2)/2L}被视为正频率，而\InsertInlineEq{\nu=(N/2)+1/(2L)}到\InsertInlineEq{\nu=(N-1)/2L}被视为负频率。
\item \InsertInlineEq{N}为偶数，\InsertInlineEq{\nu = 0/(2L)}是零频率或dc项，\InsertInlineEq{\nu=1/(2L)}到\InsertInlineEq{\nu=((N+1)/2)/2L}被视为正频率，而\InsertInlineEq{\nu=((N+3)/2)/2L}到\InsertInlineEq{\nu=(N-1)/2L}被视为负频率。}
定义了负频率之后，根据\RefEq{4.6}的\InsertInlineEq{\omega}的性质，\InsertInlineEq{\nu=(N-1)/2L}等效于\InsertInlineEq{\nu=-1/2L}，并依此类推。
\subsection{使用2D快速傅立叶变换解决光学问题}
在不考虑变换矩阵\InsertInlineEq{F}的任何属性的情况下，我们注意到计算离散傅里叶变换将需要\InsertInlineEq{N^2}乘法运算。Cooley和Tukey在1965年发布了一种利用F矩阵的对称性并将乘法运算的数量减少到\InsertInlineEq{N\log N}数量级的算法时，取得了长足的进步。
  用于计算DFT的相应算法称为快速傅立叶变换(FFT)。FFT算法的思想可以追溯到高斯（Gauss）的出版物，但是在Cooley和Tukey的工作之后，这一意义得到了重视。 FFT现在已成为基准，在计算复杂度方面经常将其与其他算法进行比较。 我们将不提供FFT理论背后的详细讨论，而只会向读者介绍使用FFT算法的操作方面，而FFT算法现在可以在广泛使用的计算工具（例如MATLAB，SciLab，NumPy等）中使用。

  正如我们将在本书的后续章节中看到的那样，傅立叶变换自然发生在光波传播，光学信息处理方法等的研究中。在光学和其他成像系统进行建模，分析和合成的数字处理方法中广泛的用到FFT算法。在这些应用中，重要的是要了解任何标准二维FFT工具提供的结果的含义以及正确使用功能，以便从物理学的角度来看这些结果有意义。

  我们将提供2D rect函数的2D傅里叶变换的计算示例。\InsertPic{16}{F4.1}{2维矩形函数的2维傅里叶变换。(a)rect函数；傅里叶变换后的振幅是（b）相位为（c）。相位函数中的暗像素和亮像素分别对应于0和\InsertInlineEq{\pi}的相位值。}如\RefFig{F4.1}所示，在大小为\InsertInlineEq{255\times255}的2D网格上定义了大小等于11个像素的rect函数。

  图\RefFig{F4.1}（b）和（c）分别显示了通过简单应用上述标准计算工具中的函数\InsertInlineEq{fft2}获得的图像的幅度和相位。 结果看起来不像预期的2D Sinc函数。我们注意到，sinc函数的中央波瓣现在分布在所得图像的拐角附近。这是因为标准FFT工具的零频分量在合成矢量的开头而不是其中心处。一个常见的解决方法是在结果上使用fftshift功能，该功能可使零频率回到图像中心。\InsertPic{17}{F4.2}{在2D矩形函数对象上应用序列\InsertInlineEq{fftshift(fft2(...))}的结果}
  在rect函数上应用序列\InsertInlineEq{fftshift(fft2(...))}分别得到如\RefFig{F4.2}（a）和（b）所示的幅度和相位这里的幅度部分看起来很合理，但是相位仍然不是期望的正弦函数。这个结果可以理解如下,将傅立叶变换计算为：\InsertEqution{4.7}{\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} d x d y \operatorname{rect}\left(\frac{x}{a}, \frac{y}{a}\right) \exp \left[-i 2 \pi\left(f_{x} x+f_{y} y\right)\right]}应用于rect函数中心的正确相位值对应于零（因为\InsertInlineEq{x=0,y=0}）。但是，根据标准FFT约定，该点的相位应用于图像的一角。 因此，必须使用标准的\InsertInlineEq{ifftshift}函数对要进行傅里叶变换的初始图像进行适当的修改，该函数通过交换象限将图像的中心移到角落。因此，要在大多数编程平台中2D FFT的适当顺序对于从物理角度来看有意义的结果（例如在描述衍射现象）中有意义，应该使用的计算顺序是\Emphasize{\InsertInlineEq{fftshift(fft2(ifftshift(...)))}}。
  \InsertPic{18}{F4.3}{在2D矩形函数对象上应用序列\InsertInlineEq{fftshift(fft2(ifftshift(...)))}的结果}
  用此序列计算出的rect函数的2D FFT的幅度和相位如图\RefFig{F4.3}(a),(b)所示。现在，振幅和相位都是光学中的常规要求。因此，合适的逆傅里叶变换可以是\Emphasize{\InsertInlineEq{fftshift(ifft2(ifftshift(...)))}}。

  函数\InsertInlineEq{fftshift}和\InsertInlineEq{ifftshift}对于偶数维矢量通常是相同的，但对于奇数维矢量则相差一个像素。而无论所涉及的矢量的维数是偶数还是奇数，上述正向和反向FFT的两个序列都可以按照光学的标准惯例用于产生正确的相位行为。
  我们已经为研究人员常用的计算工具提供了FFT例程的操作介绍。 此处通过示例说明了有关\InsertInlineEq{fftshift}和\InsertInlineEq{ifftshift}函数以及\InsertInlineEq{fft}例程的用法的细微之处。 这些主题已在此处进行了讨论，因为当初学者或学生开始研究与光学成像和衍射现象有关的基于FFT的仿真时，它们似乎是常见的错误来源。

\section{线性系统的形式和成像逆问题介绍}
借助傅立叶变换理论，我们可以掌握诸如delta函数（以及其他广义函数）和采样定理之类的思想。现在我们可以开发线性系统形式，这将在研究诸如衍射现象 ，成像系统，光息处理等方面非常有用。\InsertPic{19}{F5.1}{线性系统模型}线性系统的示意图。这张图片涉及到本书几个有趣的问题。假设一个输入信号\InsertInlineEq{g_i(x',y')}可以被表示为某些波面的复振幅或者强度。这些输入由系统变换至输出\InsertInlineEq{g_o(x,y)}。现在，我们将简单地假设输入和输出通常是复杂值的函数，而无需为其赋予任何物理意义。 当我们研究衍射，成像和其他相关主题时，其物理含义将很清楚。
这里线性的含义是，假设我们有两个输入\InsertInlineEq{g_{1i},g_{2i}}对应的输出为\InsertInlineEq{g_{1o},g_{2o}}。对于任意的线性叠加\InsertInlineEq{(\alpha g_{1i}+\beta g_{2i})},系统的输出为\InsertInlineEq{(\alpha g_{1o}+\beta g_{2o})}。在本书的后面，我们将把输入和输出功能与系统输入和输出处的光波场相关联。 有助于描述光波（电磁波）传播的麦克斯韦方程组本质上是线性的，因此线性系统模型在成像应用中的重要性并不令人惊讶。线性属性表明，\Emphasize{与其使用任意输入函数，不如使用某些基本函数集，它们构成了表示输入信号的合适基。} 然后，对系统的分析简化为研究系统对基本功能的响应。
一个有趣的基础集是位于输入平面每个点上的spikes或delta函数集。 例如，我们可以将输入表示为delta函数的总和：
\InsertEqution{5.1}{g_{i}\left(x^{\prime}, y^{\prime}\right)=\iint d u d v g_{i}(u, v) \delta\left(x^{\prime}-u, y^{\prime}-v\right)}
为了找到系统\InsertInlineEq{g_0(x,y)}的输出，我们现在要做的就是找到系统对位于每个点\InsertInlineEq{(u,v)}的delta函数的响应,通过输入\InsertInlineEq{g_i(u,v)}的值加权响应，然后在\InsertInlineEq{(u,v)}平面上积分,我们可以用\InsertInlineEq{h(x,y;x',y')}表示系统对增量峰值的响应。换句话说，如果系统的输入是在\InsertInlineEq{(x',y')}处的delta函数，则系统的响应将由\InsertInlineEq{(x,y)}平面中的函数\InsertInlineEq{h}给出。假设我们有一个显微镜在观察“点”源，输出是某种点的模糊（例如艾里环），就是函数\InsertInlineEq{h}。如果我们将要成像的对象视为点源的集合，那么生成的图像将是与对象和图像平面中的点对\InsertInlineEq{(x',y'),(x,y)}对应的模糊函数的总和。我们将\InsertInlineEq{h(x,y;x',y')}称为系统的脉冲响应。系统的输出可以表示为\InsertEqution{5.2}{g_{o}(x, y)=\iint d u d v g_{i}(u, v) h(x, y ; u, v)}
脉冲响应的想法在工程和科学的许多分支中都很常见，在物理学文献中该概念的另一个名称是格林函数。
\subsection{空不变系统脉冲响应}
当系统具有空间不变性的附加属性时，脉冲响应的想法特别有用。 如果脉冲响应的功能形式不取决于delta函数在输入平面中的位置，则系统是空间不变的。   在输入平面上移动delta脉冲的结果只是在输出平面上转换响应函数-它不会改变其形式或形状。 如果系统是空间不变的，我们可以将脉冲响应表示为：\InsertEqution{5.3}{h\left(x, y ; x^{\prime}, y^{\prime}\right)=h\left(x-x^{\prime}, y-y^{\prime}\right)}
假设位于\InsertInlineEq{(x',y')=(0,0)}的单位强度的点源产生输出\InsertInlineEq{h(x,y)}。空间不变性意味着将输入点源移至\InsertInlineEq{(x',y')=(a,b)}将产生输出\InsertInlineEq{h(x-a,y-b)}。对于大多数常见的光学成像系统，此空间不变性模型是一个很好的近似值，但是该模型并不精确。 对于典型的成像系统，空间不变性保持在光轴附近。 对于远离光轴的点，可能会观察到\InsertInlineEq{h}形式的畸变(像差)。 出于所有实际目的，我们将假定空间不变性近似是有效的，因为这将使我们能够使用傅立叶变换理论-特别是卷积性质-并开发出形式形式，以理解和分析成像现象。 通过空间不变性，线性系统的输入输出关系为卷积关系：
\InsertEqution{5.4}{g_{o}(x, y)=\iint d x^{\prime} d y^{\prime} g_{i}\left(x^{\prime}, y^{\prime}\right) h\left(x-x^{\prime}, y-y^{\prime}\right)}
可以使用傅立叶变换的卷积属性来写傅立叶空间中的等效关系：
\InsertEqution{5.5}{G_{o}\left(f_{x}, f_{y}\right)=H\left(f_{x}, f_{y}\right) G_{i}\left(f_{x}, f_{y}\right)}。\InsertInlineEq{G_o,H}和\InsertInlineEq{G_i}分别表示输出\InsertInlineEq{G_o}的2D傅里叶变换，脉冲响应h和输入\InsertInlineEq{G_i}。\InsertInlineEq{H(f_x,f_y)}描述了系统对空间频率空间中输入的影响，通常被称为系统的传递函数。一般而言，上述关系非常重要，对于研究衍射和成像现象至关重要。注意在设计新系统时，频率空间上的乘法对于概念的理解比卷积要容易得多。传递函数赋予各个空间频率一个权重，该权重通常同时具有振幅和相位。它们只是移位的delta函数基础的傅立叶变换-或复指数\InsertInlineEq{exp[i2\pi(f_x x+f_y y)]}。我们可以认为成像系统的操作如下:根据复指数分解输入和输出，并通过传递函数的数值将输入和输出的各个空间频率分量相关联。 然后可以通过逆傅立叶变换所得乘积来计算最终输出\InsertInlineEq{g_o}进入\InsertInlineEq{(x,y)}域。 当无法在整个视场上进行空间不变性近似时，可以将图像划分为小块，以使空间不变性大致保持在图像块上
\subsection{反问题的不适定性}
在上一节中，我们描述了与成像现象相关的常用线性系统模型。随着计算方法成为成像系统的组成部分，讨论一些基本问题是非常重要的，这些基本问题在解决使用输出的全部或部分测量来获得输入函数\InsertInlineEq{g_i}的反问题时会出现。我们首先观察到\InsertInlineEq{g_o}通常使用某些检测器来测量行程。如果我们关联输出场\InsertInlineEq{g_o}，那么任何光学检测器通常会检测与\InsertInlineEq{|g_o|^2}成正比的光强度。

为了简单起见并为了讨论的目的，我们可以假设在实验室中可以测量\InsertInlineEq{g_o}，例如。 通过干涉测量装置。重要的是要注意，测量过程本质上是统计上的，我们通常可以使用的输出函数包括噪声\InsertInlineEq{n(x,y)}，其最简单的形式可以被认为是可加的。
\InsertEqution{5.6}{\tilde{g}_{o}(x, y)=\iint d x^{\prime} d y^{\prime} g_{i}\left(x^{\prime}, y^{\prime}\right) h\left(x-x^{\prime}, y-y^{\prime}\right)+n(x, y)}
噪声是由于检测过程的统计性质的结合以及与光波本身相关的基本统计波动而产生的。 在任何实际系统中，噪声\InsertInlineEq{n(x,y)}永远都不理想地为零。 让我们进一步考虑与三角函数输入相关的脉冲响应\InsertInlineEq{h(x,y)}的名义形式。对于任何实际系统，传递函数\InsertInlineEq{H(f_x,f_y)}都在有限的空间频率范围内扩展，并且脉冲响应函数\InsertInlineEq{h(x,y)}的展宽与传递函数在空间频率上的展宽成反比。因此，从对象到图像空间的向前操作通常是模糊操作。

我们观察到基于测量\InsertInlineEq{\tilde{g}_{o}(x, y)}获得\InsertInlineEq{g_i(x,y)}的反问题的重要性质。考虑一个系统\InsertInlineEq{g_i(x,y)}，该方案理想情况下会在系统的输出处生成\InsertInlineEq{g_o(x,y)}。 有趣的是，任何形式的\InsertInlineEq{g_i(x,y)+Acos(\omega_x x+\omega_y y)}的任何其他方案，对于足够大的\InsertInlineEq{\omega_x,\omega_y}值，因为\InsertInlineEq{h(x,y)}的模糊性导致高振荡的加权平均项平均为零。

在如此宽泛的解决方案之间进行区分并不容易，因为它们在输出端的噪声限制内产生几乎相同的输出。这种差异很大的输入功能可能在实验室环境中产生几乎无法区分的输出的可能性通常称为ill-posedness。Hadamard在1920年代首次正式讨论了不适定性作为实际反问题的一般属性。为了解决ill-posedness带来的困难，需要精心设计反问题，以便可以通过任何实际的计算成像来获得针对当前问题的有意义的解决方案。在以下各节中，我们将说明这方面的一些重要方法。

\subsection{逆滤波}
逆滤波器是解决从测量的输出\InsertInlineEq{\tilde{g_o}}获得输入\InsertInlineEq{g_i(x,y)}的问题的一种简单解决方案。此处包含此方法，因为它清楚地说明了上一部分中讨论的由于不适而造成的困难。 忽略输出中的噪声并使用等\RefEq{5.5}，名义上可以将逆解写为：
\InsertEqution{5.7}{g_{i}(x, y)=\mathcal{F}^{-1}\left[\frac{G_{o}\left(f_{x}, f_{y}\right)}{H\left(f_{x}, f_{y}\right)}\right]}
函数\InsertInlineEq{1/H(f_x,f_y)}在这里被称为逆滤波器。不幸的是，我们无法知道\InsertInlineEq{G_o(f_x,f_y)}，而只能访问它的噪声版本\InsertInlineEq{\tilde{G}_{o}\left(f_{x}, f_{y}\right)=\mathcal{F}\left[\tilde{g}_{o}(x, y)\right]}。 使用噪声输出\InsertInlineEq{\tilde{g_i}(x,y))}的估计可以写为：
\InsertEqution{5.8}{\tilde{g}_{i}(x, y)=\mathcal{F}^{-1}\left[\frac{\tilde{G}_{o}\left(f_{x}, f_{y}\right)}{H\left(f_{x}, f_{y}\right)}\right]}
在数值计算中，可以用小的常数替换H中的任何零值，以避免被零除。\InsertPic{20}{F5.2}{简单逆滤波的例子。（a）原始图（b）使用\InsertInlineEq{20\times20}的平均并且添加均匀随机噪声。（c）逆滤波复原图}\RefFig{F5.2}中的插图显示了20×20像素平方平均滤波器（具有1％的附加噪声）对图片的影响，然后尝试使用简单的逆滤波器进行图像恢复。
\InsertPic{21}{F5.3}{（a）图5.2中使用的20 20像素平均滤波器\InsertInlineEq{h(x,y)}和（b）相应的传递函数\InsertInlineEq{H(f_x,f_y)}的绝对值。}滤波器\InsertInlineEq{h(x,y)}和相应的传递函数\InsertInlineEq{H(f_x,f_y)}的绝对值如\RefFig{F5.3}所示。\RefFig{5.2}中的恢复似乎完全没有意义。 这是因为我们仅将模糊图像的傅立叶变换除以H傅立叶变换。函数\InsertInlineEq{H(f_x,f_y)}在有限区域或孤立的线/点上具有零（或非常小的值），如\RefFig{5.3}所示，并且除以这些小值会大大增强相应的频率分量。特别是在存在噪音的情况下，其中一些组件可能会在恢复过程中产生完全不希望的大振荡，如\RefFig{5.2}所示。要注意的是，如果将平均滤波器\InsertInlineEq{h(x,y)}应用于该恢复，则其产生的结果与\RefFig{5.2}（b）中的模糊图片几乎相同。因此，这是一种与模糊图像数据一致的解决方案，但从实际角度来看，这种恢复根本没有用。该图显示了由于反问题的不适定性造成的困难。因此，诸如逆滤波器之类的简单解决方案是不合适的。 必须构造一种解决方案，该解决方案可提供视觉上有意义的结果，并与模糊图像数据合理地保持一致。我们观察到，即使对于一个简单的问题，也需要对逆进行更复杂的处理来以获得有用的图像恢复。
\subsection{维纳滤波}
Norbert Wiener首次提出了使用噪声的统计特性来设计适当的逆恢复滤波器的想法。 我们将假设一个滤波器\InsertInlineEq{\omega(x,y)}使得当将其应用于输出\InsertInlineEq{\tilde{g}_{o}(x, y)}时，解\InsertInlineEq{\tilde{g}_{i}(x, y)}的估计为
\InsertEqution{5.9}{\tilde{g}_{i}(x, y)=\iint d x^{\prime} d y^{\prime} \tilde{g}_{o}\left(x^{\prime}, y^{\prime}\right) w\left(x-x^{\prime}, y-y^{\prime}\right)}
为了获得与噪声数据一致的信号，进一步的解决方案是预期的最小二乘误差：
\InsertEqution{5.10}{\epsilon=<\left\|g_{i}(x, y)-\tilde{g}_{i}(x, y)\right\|^{2}>}
是最小的。符号\InsertInlineEq{||...||}表示标准得L2范数，\InsertInlineEq{<...>}表示集合平均。为了导出滤波器，我们将通过利用Parseval定理\footnote{\InsertInlineEq{\begin{array}{l}
  \int_{\infty}^{\infty} d f_{x}\left|G\left(f_{x}\right)\right|^{2} \\
  =\int_{-\infty}^{\infty} d x \int_{-\infty}^{\infty} d x^{\prime} g(x) g^{*}(x) \delta\left(x-x^{\prime}\right) \\
  =\int_{-\infty}^{\infty} d x|g(x)|^{2}
  \end{array}}},在傅立叶变换中表达误差\InsertInlineEq{\epsilon}。
  \InsertEqution{5.11}{\begin{aligned}
    \epsilon &=<\left\|G_{i}\left(f_{x}, f_{y}\right)-\tilde{G}_{i}\left(f_{x}, f_{y}\right)\right\|^{2}>\\
    &=<\left\|G_{i}\left(f_{x}, f_{y}\right)-W\left(f_{x}, f_{y}\right)\left[G_{i}\left(f_{x}, f_{y}\right) H+N\left(f_{x}, f_{y}\right)\right]\right\|^{2}>\\
    &=<\left\|(1-W H) G_{i}-W N\right\|^{2}>
    \end{aligned}}
    这里\InsertInlineEq{W(f_x,f_y),N(f_x,f_y)}是\InsertInlineEq{\omega(x,y),n(x,y)}的傅里叶变换。我们将展开上述表达式中的项，并将包含\InsertInlineEq{<G_{i}\left(f_{x}, f_{y}\right) N^{*}\left(f_{x}, f_{y}\right)>}或其复共轭的交叉项等同为零。这是有道理的，因为预计噪声不会与我们要恢复的输入对象函数\InsertInlineEq{{g}_{i}(x, y)}相关。
    此外，我们将与物体和噪声相关的功率谱表示为：\InsertInlineEq{S_{o b j}\left(f_{x}, f_{y}\right)=<\left|G_{i}\left(f_{x}, f_{y}\right)\right|^{2}>,S_{\text {noise}}\left(f_{x}, f_{y}\right)=<\left|N\left(f_{x}, f_{y}\right)\right|^{2}>}。
    上面的平方误差现在可以更明确地写为：
    \InsertEqution{5.12}{\begin{aligned}
      {\epsilon=\iint d f_{x} d f_{y}\left[\left|1-W\left(f_{x}, f_{y}\right) H\left(f_{x}, f_{y}\right)\right|^{2} S_{o b j}\left(f_{x}, f_{y}\right)\right.}\\{\left.+\left|W\left(f_{x}, f_{y}\right)\right|^{2} S_{\text {noise}}\left(f_{x}, f_{y}\right)\right]}
      \end{aligned}}
      我们注意到，误差\InsertInlineEq{\epsilon}是\InsertInlineEq{W,W*}的函数。 为了找到使误差最小的适当\InsertInlineEq{W(f_x,f_y)}，我们必须将\InsertInlineEq{\nabla_{W^{*}} \epsilon}等于0，并且得到的\InsertInlineEq{W(f_x,f_y)}解由下式给出：
      \InsertEqution{5.13}{W\left(f_{x}, f_{y}\right)=\frac{H^{*}\left(f_{x}, f_{y}\right)}{\left|H\left(f_{x}, f_{y}\right)\right|^{2}+\frac{S_{\text {noise}}\left(f_{x}, f_{y}\right)}{S_{\text {obsec}}\left(f_{x}, f_{y}\right)}}}
      有关为了最小化目的而针对共轭\InsertInlineEq{W*}采取梯度的更多详细信息，读者将必须等到下一章约束优化。滤波器明确包含对象和噪声功率谱。上面分母中的第二项是特定空间频率\InsertInlineEq{(f_x,f_y)}处的信噪比（SNR）的倒数。对于SNR高的空间频率，我们得到的表达式接近于逆滤波器，而当SNR非常低时，滤波器有效地从恢复中消除了相应的空间频率。对物体和噪声功率谱的大概了解足以满足大多数实际目的。功率谱可以基于与特定类别的图像（例如自然风光，面部，文本等）相关联的平均傅立叶谱，该特定类别的图像可能对解决特定问题。
      \InsertPic{22}{F5.4}{（a）使用维纳滤镜进行图像恢复，（b）恢复图像的放大部分}
      在\RefFig{5.4}（a）中，使用了与上一节的相同示例，我们显示了使用维纳滤波器的图像恢复。

  我们注意到，与\RefFig{F5.2}(c)相比，现在的恢复更有意义。滤波器已恢复在模糊过程中丢失的细节。如\RefFig{F5.4}（b）所示，结果在外观上也有些嘈杂，并且在尖锐边缘附近有一些振铃伪影，这是\RefFig{F5.4}（a）中一小部分恢复后的放大图。 这些伪像是维纳过滤器恢复过程的典型特征。 尽管维纳滤波器考虑了噪声功率谱，但是恢复图像的感知质量不一定是最佳的。 例如，具有低局部噪声的图像仍保留清晰的边缘，具有更好的视觉质量。 可以通过选择适当的约束将这种要求合并到重构算法中，这将在下一章中进行介绍。

  从此处所示的模糊和嘈杂的版本恢复合理的图像，使我们可以考虑计算光学成像系统，其中记录的原始数据不能很好地表示我们希望恢复的图像。 然后去模糊操作（例如使用维纳滤波器）恢复更合适的图像。 系统设计涉及针对原始数据记录的受控模糊处理，通过对图像进行去模糊处理，可以在设计中提供很大的灵活性，并允许有趣的应用程序，例如扩展的景深成像，这将在本书的后面部分进行介绍。
\section{图像恢复中的约束优化算法}
我们指出，任何计算系统的组成部分都必须使用记录的图像传感器数据来解决某些逆成像问题。   现在在越来越多的计算成像系统中，将此逆问题建模为优化问题，并应用适当的约束来推动数值优化过程的求解朝着有意义的图像方向发展。 在本章中，我们将讨论约束优化算法和一些简单的过程来解决此类问题，并为感兴趣的读者提供指向更高级技术的指南。 我们将从图像降噪问题开始讨论，然后再进行图像去卷积，最后以介绍令人兴奋的最新想法（例如压缩成像）作为结束。 尽管对于逆成像问题可以使用多种约束选择，但在本章中，我们将考虑总变化最小化约束作为一个具体示例。 之所以选择这种约束，是因为从图像质量的角度来看，约束的选择非常强大，其次，它不需要任何知识，例如小波或相关变换，都不在本书的讨论范围之内。
\subsection{图像去噪}
图像或视频数据构成了数字数据流的主要部分。 即使使用精心设计的成像系统也经常遇到的问题之一是所记录图像的嘈杂外观，给最终用户带来低图像质量的感觉。 噪音来自各种因素，例如 来自传感器的电子读出噪声，照明光束中光子数的统计变化以及检测过程的统计性质。 尽管可能会争辩说可以通过使用足够的光照水平来降低噪声，但是有一些应用程序，例如(i)天文学，其中光照水平本来就很低；或者(ii)医学X射线成像，其中不希望增加X射线剂量。 因此，从图像中去除噪声是重要的实际问题。 虽然去噪不是一个完整的反问题，但这是本章的一个很好的起点。
\InsertPic{23}{F6.1}{典型的荧光显微图（a）和高斯滤波后的图像（b）}
给定一个噪声图像\InsertInlineEq{g(x,y)},我们可以找到一个与\InsertInlineEq{g(x,y)}相近的图像\InsertInlineEq{\hat{g}(x,y)},满足减少噪声的同时保持图像的边缘。这个问题可以转换为最小化一个损失函数\InsertInlineEq{C(\hat{g})}:
\InsertEqution{6.1}{C(\hat{g})=\frac{1}{2}\|g(x, y)-\hat{g}(x, y)\|^{2}+\alpha \psi(\hat{g})}
\InsertInlineEq{\alpha}是一个实数，\InsertInlineEq{\psi}是一个玉树方程。一个应用广泛的\InsertInlineEq{\psi}是总变分函数（TV）：
\InsertEqution{6.2}{\psi(\hat{g})=T V(\hat{g})=\|\nabla \hat{g}\|_{1}=\sum_{m, n}|\nabla \hat{g}|_{m, n}}。
TV功能被视为梯度的L1范数，在上面的最后一项中对其进行了更明确的定义。 索引(m,n)表示图像中的像素索引。 因此，任何给定图像的电视中每个像素的贡献都与该像素处的梯度大小成比例。 还可以设计罚分，使得该贡献与梯度的L2-范数平方成比例。 但是，以L1范数的形式进行惩罚会使噪声引起的局部振荡相对较小。 由于边缘在典型图像中占据的像素相对较少，因此与使用L1-norm惩罚时边缘引起的相比，小局部振荡对惩罚函数的贡献通常更高。 最小化等式中成本函数的任何数值程序。 因此，\RefEq{6.1}在保持边沿的同时，对于小的局部振荡非常重要。
使用梯度下降去最小化损失函数\RefEq{6.1}。给定一个初始猜测\InsertInlineEq{\tilde{g}},我们期望一个小的变量\InsertInlineEq{\delta\hat{g}}有如下形式：
\InsertEqution{6.3}{C(\hat{g}+\delta\hat{g})<C(\hat{g})}
如果使\InsertInlineEq{\delta \hat{g}}与损失函数的负梯度成比例，则不等式成立。 因此，使用梯度下降的迭代过程如下：
\InsertEqution{6.4}{\hat{g}^{(n+1)}=\hat{g}^{(n)}-t\left[\nabla_{\hat{g}} C(\hat{g})\right]_{\hat{g}=\hat{g}^{(n)}}}
\InsertInlineEq{t}是负梯度反方向的步长，为每次迭代确定t的数值，以确保成本函数确实按照\RefEq{6.3}减少。 例如，可以从某个标称值\InsertInlineEq{t=1}开始，并获得\InsertInlineEq{\hat{g}^{n+1}}的测试猜测。如果此猜测不满足\RefEq{6.3}，\InsertInlineEq{t}减小为（例如\InsertInlineEq{t/2}），依此类推，直到满足此条件。

在这一点上，我们目前讨论一种的实际正值损伤函数的通用优化方法：
\InsertEqution{6.5}{C(\hat{g})=\iint d x d y \mathcal{L}\left(\hat{g}, \nabla_{x} \hat{g}, \nabla_{y} \hat{g}\right)}
\RefEq{6.1}也已经包括在这个形式中。注意到，\InsertInlineEq{C(\hat{g})}在\InsertInlineEq{\hat{\beta}}方向上的方向导数由下式给出:
\InsertEqution{6.6}{\begin{aligned}
  \frac{\partial C(\hat{g})}{\partial \hat{\beta}} &=\lim _{\epsilon \rightarrow 0} \frac{C(\hat{g}+\epsilon \hat{\beta})-C(\hat{g})}{\epsilon} \\
  &=\nabla_{\hat{g}} C \cdot \hat{\beta} \\
  &=\iint d x d y\left(\nabla_{\hat{g}} C\right)(x, y) \hat{\beta}(x, y)
  \end{aligned}}
  按照对变分演算问题的常规处理，我们将假设变化\InsertInlineEq{\epsilon \hat{\beta}}的解\InsertInlineEq{\hat{g}}在图像边界处为零。然后我们有：
  \InsertEqution{6.7}{C(\hat{g}+\epsilon \hat{\beta})=C(\hat{g})+\epsilon \nabla_{\hat{g}} C(\hat{g}) \cdot \hat{\beta}}
  另外，可以用项\InsertInlineEq{\mathcal{L}\left(\hat{g}, \nabla_{x} \hat{g}, \nabla_{y} \hat{g}\right)}表示\RefEq{6.5}功能梯度并具有Euler-Lagrange形式：
  \InsertEqution{6.8}{\nabla_{\hat{g}} C(\hat{g})=\left[\frac{\partial \mathcal{L}}{\partial \hat{g}}-\frac{\partial}{\partial x}\left(\frac{\partial \mathcal{L}}{\partial\left(\nabla_{x} \hat{g}\right)}\right)-\frac{\partial}{\partial y}\left(\frac{\partial \mathcal{L}}{\partial\left(\nabla_{y} \hat{g}\right)}\right)\right]}
  在设计使用迭代方案的优化算法（例如\RefEq{6.4}中描述的梯度下降方案）时，通常可以使用此函数梯度公式。

  当使用如\RefEq{6.1}中的TV损失函数时。功能梯度可以明确地写为：
  \InsertEqution{6.9}{\nabla_{\hat{g}} C(\hat{g})=-(g-\hat{g})-\alpha \nabla \cdot\left(\frac{\nabla \hat{g}}{|\nabla \hat{g}|}\right)} 
  要注意的一个实施细节是\RefEq{6.9}第二项中的分母通常近似为：
  \InsertEqution{6.10}{|\nabla \hat{g}| \approx \sqrt{|\nabla \hat{g}|^{2}+\delta^{2}}}
  \InsertPic{24}{F6.2}{用TV进行去噪：（a）和（b）中分别使用权重参数\InsertInlineEq{\alpha=0.025,\alpha=0.25}的值}
  对于较小的正常数δ我们避免在图像的恒定或平坦区域中除以零。 \RefEq{6.9}中的第二项被认为是一种各向异性的扩散形式，其扩散系数与局部梯度幅度成反比，这是思考电视罚分的边缘保持特性的另一种方式。在\RefFig{F6.2}的图示中,对于参数α的两个不同值显示了迭代过程的结果 在每种情况下，已经使用了20次算法迭代。 我们观察到，当\InsertInlineEq{\alpha}设置为一个较小的值时，解决方案看起来类似于原始的噪点图像。 此外，与\RefFig{6.1}(b)中的高斯滤波图像相比，\RefFig{6.2}(b)中的降噪图像保留了更好的边缘信息和清晰度，因此证明了基于TV的降噪优于线性滤波。
\subsection{利用最优化进行图像解卷积}
在本节中，我们为上一节中描述的降噪问题增加了一些复杂性，并研究以TV损失分作为约束项的图像恢复问题。在这种情况下，数据是带有噪声的模糊图像，我们将尝试对其进行恢复。数据模型如下
\InsertEqution{6.11}{g_{o}(x, y)=h(x, y) * g_{i}(x, y)+n(x, y)}
也可以用矩阵运算符形式表示为：
\InsertEqution{6.12}{g_{o}=A g_{i}+n}
用A表示系统或模糊的线性算子。 以与上一节类似的方式，我们对优化问题建模，其中损失函数定义为：
\InsertEqution{6.13}{C\left(\hat{g}_{i}\right)=\frac{1}{2}\left\|g_{o}-A \hat{g}_{i}\right\|^{2}+\alpha T V\left(\hat{g}_{i}, \hat{g}_{i}^{*}\right)}
在这里，我们假设图像\InsertInlineEq{\hat(g)_i}通常是复数，损失函数\InsertInlineEq{C}是\InsertInlineEq{\hat(g)_i,\hat(g)_i^*}的实数值函数。TV损失在这里定义为：
\InsertEqution{6.14}{T V\left(\hat{g}, \hat{g}^{*}\right)=\|\nabla g\|_{1}=\sum_{i} \sqrt{\left(\nabla_{x} \hat{g}_{i}\right)\left(\nabla_{x} \hat{g}_{i}^{*}\right)+\left(\nabla_{y} \hat{g}_{i}\right)\left(\nabla_{y} \hat{g}_{i}^{*}\right)}}
注意到，\InsertInlineEq{C}的变化现在可以表示为：
\InsertEqution{6.15}{\begin{aligned}
  \delta C\left(\hat{g}_{i}, \hat{g}_{i}^{*}\right) &=\frac{\partial C}{\partial \hat{g}_{i}} \delta \hat{g}_{i}+\frac{\partial C}{\partial \hat{g}_{i}^{*}} \delta \hat{g}_{i}^{*} \\
  &=2 \operatorname{Re}\left[\frac{\partial C}{\partial \hat{g}_{i}} \delta \hat{g}_{i}\right] \\
  &=2 \operatorname{Re}\left[\left(\frac{\partial C}{\partial \hat{g}_{i}^{*}}\right)^{*} \delta \hat{g}_{i}\right]
  \end{aligned}}
因为损失函数\InsertInlineEq{C}是实数，将Cauchy-Schwartz不等式应用于\InsertInlineEq{\operatorname{Re}\left[\left(\frac{\partial C}{\partial \hat{g}_{i}^{i}}\right)^{*} \delta \hat{g}_{i}\right]},上面告诉我们，当变量\InsertInlineEq{\delta \hat{g}_i}沿方向\InsertInlineEq{\left[\partial C / \partial \hat{g}_{i}^{*}\right]}可以达到\InsertInlineEq{\delta C}最大值。因此，使用梯度下降方案的去模糊问题的迭代解写如下：
\InsertEqution{6.16}{\hat{g}_{i}^{(n+1)}=\hat{g}_{i}^{(n)}-t\left[\nabla_{\hat{g}_{i}^{*}} C\left(\hat{g}_{i}, \hat{g}_{i}^{*}\right)\right]_{\hat{g}_{i}=\hat{g}_{i}^{(n)}}}
我们注意到，当计算函数梯度\InsertInlineEq{C}时\InsertInlineEq{\hat{g}^*_t,\hat{g}_i}应视为常数，反之亦然。 \RefEq{6.13}中成本函数的函数梯度可以被写成：
\InsertEqution{6.17}{\nabla_{\hat{g}_{i}} C\left(\hat{g}_{i}\right)=-\frac{1}{2} A^{\dagger}\left(g_{o}-A \hat{g}_{i}\right)-\frac{1}{2} \alpha \nabla \cdot\left(\frac{\nabla \hat{g}_{i}}{\left|\nabla \hat{g}_{i}\right|}\right)}
上面出现因数1/2是因为L2范数和TV项现在都是根据复数定义的。为了进一步进行，当系统模糊算子A对应于脉冲响应\InsertInlineEq{h(x,y)}的卷积时，我们需要明确定义伴随算子\InsertInlineEq{A^{\dagger}}。 我们首先将属于输出或图像空间的两个函数的标量积定义为：
\InsertEqution{6.18}{\left(g_{o 1}, g_{o 2}\right)=\iint d x d y g_{o 1}^{*}(x, y) g_{o 2}(x, y)}
伴随算子\InsertInlineEq{A^{\dagger}}定义为满足属性：
\InsertEqution{6.19}{\left(g_{o 1}, A g_{i 2}\right)=\left(A^{\dagger} g_{o 1}, g_{i 2}\right)}
这里的函数\InsertInlineEq{g_{i2}}属于输入或对象空间。 当A的作用等效于具有冲激响应\InsertInlineEq{h(x,y)}的卷积时，我们有：
\InsertEqution{6.20}{\begin{aligned}
  &\iint d x d y g_{o 1}^{*}(x, y)\left[\iint d x^{\prime} d y^{\prime} h\left(x-x^{\prime}, y-y^{\prime}\right) g_{i 2}\left(x^{\prime}, y^{\prime}\right)\right] \\
  &=\iint d x^{\prime} d y^{\prime}\left[\iint d x d y h^{*}\left(x-x^{\prime}, y-y^{\prime}\right) g_{o 1}(x, y)\right]^{*} g_{i 1}\left(x^{\prime}, y^{\prime}\right)
  \end{aligned}}
  \InsertPic{25}{F6.3}{（a）使用TV约束优化进行图像恢复，（b）恢复图像的放大部分}
  可以观察到，与卷积运算相对应的伴随算符\InsertInlineEq{A^{\dagger}}是另一个具有函数\InsertInlineEq{h^*(-x,-y)}的卷积。 现在可以像\RefEq{6.17}式中那样在功能梯度评估中使用。在\RefFig{F6.3}的插图中，我们使用带有TV损失的约束优化方案显示了\RefFig{F5.2}(b)中模糊图像的恢复，如\RefEq{6.3}所示。迭代参数是\InsertInlineEq{\alpha=1},进行了10代梯度下奖。 我们从恢复图像的放大部分观察到，与使用维纳滤波器进行图像恢复的图\InsertInlineEq{5.4}（b）相比，现在的振铃伪影已大大减少。 然而，维纳滤波器解决方案是通过单步非迭代过程获得的，因此可以用作基于优化的迭代解决方案的第一个猜测。当解决方案受适当的惩罚函数约束时，基于解决方案的解决方案通常可显着提高图像质量。 尽管图像质量是本书讨论范围之外的主题，但必须注意，在几种应用程序（例如诊断成像）中，最终用户感知的图像质量在图像恢复算法的设计中起着非常重要的作用。
\subsection{盲去卷积}
在本节中，我们将讨论一种不寻常的图像恢复方法-盲反卷积方法，该方法甚至可以在不知道脉冲响应\InsertInlineEq{h(x,y)}的情况下恢复模糊图像。 该问题需要交替的两步优化方法，其中去模糊的图像和脉冲都将在适当的约束下进行更新，直到两个函数都收敛到适当的解决方案为止。优化的目标如下：
固定\InsertInlineEq{h}，最小化\InsertEqution{6.21}{\left\|g_{o}-h * g_{i}\right\|^{2}+\alpha_{1} \psi_{1}\left(g_{i}\right)},
固定\InsertInlineEq{g_i},最小化\InsertEqution{6.22}{\text { Minimize }\left\|g_{o}-h * g_{i}\right\|^{2}+\alpha_{2} \psi_{2}(h)}
这里\InsertInlineEq{\psi_1,\psi_2}表示要恢复的图像\InsertInlineEq{g_i}和脉冲响应\InsertInlineEq{h}的约束。显然由于\InsertInlineEq{h_i,g_i}都是未知的，因此该问题的解是无限的。因此，对恢复图像的约束和模糊函数在确定解决方案中都起着关键作用，这两个问题都基于问题的物理原理是有意义的。盲解卷积过程通常是迭代执行的，以便在第\InsertInlineEq{n+1}次迭代中使用以下步骤：
\InsertItem{
  \item 从模糊图像数据\InsertInlineEq{g_o(x,y)}和脉冲响应\InsertInlineEq{h^{(n)}}
  \item 找到一个猜测解\InsertInlineEq{g_i^{(n+1)}(x,y)}通过解决\RefEq{6.13}的约束优化问题来对图像进行去卷积处理,其中\InsertInlineEq{h^{(n)}(x,y)}被认为是一个常数。在这种情况下的约束将是对期望的去卷积图像的适当约束。
  \item 将\InsertInlineEq{g_i^{n+1}(x,y)}另一个约束作为优化，使用\RefEq{6.13}进行迭代卷积核，这时脉冲响应被更新为\InsertInlineEq{h^{(n+1)(x,y)}}。现在，优化中的约束项是指卷积核函数的所需属性。
}
\InsertPic{26}{F6.4}{盲去卷积的说明（a）模糊图（b）恢复的解卷积图（c）恢复的脉冲响应函数的放大部分}
通过设置对模糊函数初始猜测\InsertInlineEq{h^{(0)}(x,y)}来启动迭代。 众所周知，初始猜测值\InsertInlineEq{h^{(0)}(x,y)}的近似大小或支持对于在实践中实现算法的良好收敛起着重要作用。可以首先从模糊图像数据中的任何可识别特征来估计模糊功能的支持。 在\RefFig{F6.4}的图示中，我们显示了使用盲反卷积方法恢复条形码的模糊图像。 在此，将正约束用于模糊图像和模糊函数。 另外，将TV用于去模糊的图像,该方法严格取决于所使用的约束，因此在设计实用算法时需要仔细考虑这一方面。 通过大气湍流和消除数字成像中的运动模糊，盲反卷积已在天文成像中找到了实际应用。
\subsection{压缩成像}
在这一部分，我们转向一个有趣的应用——压缩成像——约束优化框架。过去二十年对图像压缩标准的研究表明，自然图像是可压缩的。换句话说，典型图像中的自由度数量通常比用来表示它的像素数量少得多。例如，如果我们在视觉上观察\RefFig{F5.2}(a)中的图像，我们观察到有几个平坦或平滑的区域，其中数值在局部上几乎是恒定的或者在像素之间缓慢变化。像素值中的这些相关性可以被有效地用于图像的存储，正如现在在广泛使用的图像压缩标准如JPEG2000中所做的那样。如果在某些应用中要记录的大多数图像预期具有某种结构并因此具有可压缩性，那么要说明的第一个问题就是:

生成一幅N像素图像需要多少次测量？

对于\RefEq{6.12}中的成像模型,这个问题的简单而传统的答案（不考虑图像\InsertInlineEq{g_i}中的任何可压缩性）是我们将需要大约N次测量来生成N个像素图像。 原因是是\RefEq{6.12}是一个线性方程组，为了找到N个未知像素值，我们需要与未知数一样多的方程。   但是，如果我们假设要恢复的图像是可压缩的，那么直观上可以想到，远小于N的测量次数就足够了。我们通过傅立叶域测量的具体示例来说明这一点。
\InsertPic{27}{F6.5}{(a)Logo 图案\InsertInlineEq{g(x,y)},(b)傅里叶变换幅值对数显示\InsertInlineEq{|G(f_x,f_y)|},(c)梯度图\InsertInlineEq{|\nabla g(x, y)|}}
傅立叶域测量通常发生在光学-医学成像模式（如MRI和X射线CT），或者射电天文学等领域。 考虑一个图像\InsertInlineEq{g(x,y)}及其傅里叶变换\InsertInlineEq{G(f_x,f_y)}，分别如\RefFig{F6.5}(a),(b)所示。如果在傅立叶域中测量了全部数据，则可以使用傅立叶逆变换对\InsertInlineEq{G(f_x,f_y)}进行求逆，以获得图像\InsertInlineEq{g(x,y)}。 但是，我们观察到图像\InsertInlineEq{g(x,y)}在梯度域中是稀疏的。如果我们如图\RefFig{F6.5}（c）所示观察梯度幅值图像，则会观察到具有明显梯度幅值的像素数量远小于像素总数。
\InsertPic{28}{F6.6}{(a)二值化掩码\InsertInlineEq{M(f_x,f_y)},(b)\InsertInlineEq{|M(f_x,f_y)G(f_x,f_y)|}}
我们能否以某种方式利用这种梯度域稀疏性？ 例如，我们可能在\RefFig{F6.6}(a)所示的二进制（0,1）掩码\InsertInlineEq{M(f_x,f_y)}中显示为亮像素的位置处随机地仅测量\InsertInlineEq{N/4}个傅立叶域样本。 相应的掩蔽傅立叶数据如\RefFig{F6.6}（b）所示。 在求解N个未知像素值的常规意义上，傅里叶域中的\InsertInlineEq{N/4}个数据点显然是不完整的。 当数据样本的数量远小于N时，我们需要求解的方程组不完整。 原则上，这种不完整的线性方程组具有无限数量的解。为了找到合适的解决方案，我们需要一些其他准则来决定选择哪种解决方案。作为首次尝试，我们通过最小化成本函数来考虑L2-范数平方解决方案：
\InsertEqution{6.23}{C\left(g_{i}, g_{i}^{*}\right)=\frac{1}{2}\left\|M\left(f_{x}, f_{y}\right)\left[G\left(f_{x}, f_{y}\right)-\mathcal{F}\left\{g_{i}(x, y)\right\}\right]\right\|^{2}}
\InsertPic{29}{F6.7}{（a）最小平方L2-范数问题的图像恢复，如\RefEq{6.23}所示（b）带有TV惩罚的最小平方L2-范数问题\RefEq{6.24}所示}
请注意，此处我们正在寻找最小二乘意义上的最佳解决方案，该解决方案需要根据掩模定义在傅立叶域中的测量位置进行接近\InsertInlineEq{G(f_x,f_y)}的傅立叶变换。 这个最小化问题的解决方案\RefFig{6.7}(a)所示。 我们观察到最小二乘解显然质量较差，在任何实际应用中均无用。如上所述，由于我们希望解决方案在梯度域中比较稀疏，因此可以通过将成本函数重新定义为以下形式，将该信息合并到成本函数中：
\InsertEqution{6.24}{
  C\left(g_{i}, g_{i}^{*}\right)=\frac{1}{2}\left\|M\left(f_{x}, f_{y}\right)\left[G\left(f_{x}, f_{y}\right)-\mathcal{F}\left\{g_{i}(x, y)\right\}\right]\right\|^{2} \\
  +\alpha T V\left(g_{i}, g_{i}^{*}\right)}
  图6.7（b）中显示了结合TV损失的相应问题的方案效果，其中我们观察到25％傅里叶测量值的接近完美的图像恢复。 上面的两个优化问题都是使用\RefEq{6.16}和\RefEq{6.17}中描述的迭代方案解决的。在此图中，伴随运算符\InsertInlineEq{A^{\dagger}}对应于受掩码\InsertInlineEq{M(f_x,f_y)}约束的傅立叶数据的傅立叶逆变换。
\subsubsection{二次采样数据测量和图像恢复指南}
尽管我们已经看到了传统意义上不完整的数据具有出色的图像恢复能力，但变换的选择和测量方案仍需要进一步讨论。为了简化符号，我们将假定解\InsertInlineEq{g(x,y)}可以根据函数\InsertInlineEq{\left\{\phi_{n}(x, y)\right\}}的基础集进行展开：
\InsertEqution{6.25}{g(x, y)=\sum_{n} \beta_{n} \phi_{n}(x, y)}
进一步，我们假设基础的选择是使得由所有系数\InsertInlineEq{\beta_n}组成的向量\InsertInlineEq{\boldsymbol{\beta}}本质上是稀疏的。 换句话说，与\InsertInlineEq{N}相比，少量的系数\InsertInlineEq{\beta_n}是非常显著的。 基础的选择通常可以是基于比例尺的基础，例如已知对表示自然图像有效的一些小波族,使用的方程依然如\RefEq{6.12}所示：
\InsertEqution{6.26}{g_{o}=A \sum_{n} \beta_{n} \phi_{n}(x, y)+n(x, y)}
压缩感测问题是指在\InsertInlineEq{\boldsymbol{\beta}}是稀疏向量的先验约束下恢复系数\InsertInlineEq{\beta_n}。 如Candes，Romberg和Tao（2006）所示，对于由以下公式给出的成本函数，可以将此问题建模为最小化问题：
\InsertEqution{6.27}{C(\boldsymbol{\beta})=\frac{1}{2}\left\|g_{o}-A \sum_{n} \beta_{n} \phi_{n}(x, y)\right\|^{2}+\alpha\|\boldsymbol{\beta}\|_{1}}
在这里，\InsertInlineEq{\boldsymbol{\beta}}的稀疏性是通过施加L1范数惩罚来实现的。 更明确地是\InsertInlineEq{||\boldsymbol{\beta}||_1=\sum_n |\beta_n|} 。\RefEq{F6.7}中用于说明的TV损失除了图像表示不是方程的基的集合之外也是L1-norm损失的一个例子。

稀疏性和L1范数之间的粗略的联系是L1域中的球是“尖的”（例如，在2D中，相对于L1范数的单位球是\InsertInlineEq{|x_1|+|x_2|=1}而不是\InsertInlineEq{x^2_1+x^2_2=1}）。满足数据约束以及L1惩罚的最佳解决方案是，表示数据约束的超曲面与以轴为系数\InsertInlineEq{\beta_n}的大维空间中的L1球面相交。L1球体的“尖角”性质表明，解决方案的系数\InsertInlineEq{\beta_n}稀疏。上面的几何图形不容易想象，但是，可以得出这样的事实：TV惩罚偏爱边缘稀疏的解决方案，以及恢复区中大部分平坦（小梯度）区域的解决方案。最后，为了完整起见，我们要提到的是，按照严格的压缩成像（或传感）理论，如果一个N像素图像在某种稀疏性的基础上很可能具有\InsertInlineEq{K(<<N)}个重要系数的表示形式，则需要进行多次测量为了通过适当的算法进行期望的图像恢复，需要\InsertInlineEq{K \log N}的数量级次迭代。
\InsertPic{30}{F6.8}{以像素为单位的稀疏图像：白点显示的像素很少为非零，而所有其他像素为零}

关于压缩成像方法的另一个重要方面是测量方案与图像可能稀疏的基础之间的关系。 我们将以一个涉及像素稀疏性的简单案例来说明这一点。考虑一个以像素为单位的稀疏图像，如\RefFig{F6.8}所示,假设我们希望根据\RefEq{6.26}中的模型测量对应于这个稀疏对象的输出\InsertInlineEq{g_o}。我们注意到每个测量点\InsertInlineEq{g_{oj}}对应一个线性组合:
\InsertEqution{6.28}{g_{o j}=\sum_{n} \beta_{n}\left(A_{j}, \phi_{n}\right)+\text { noise }}
这里\InsertInlineEq{A_j,\phi_n}表示矩阵\InsertInlineEq{A}的第j行（测量基的第j个元素），\InsertInlineEq{\phi_n}是稀疏基函数。首先让我们注意，在这种情况下，稀疏基是像素基。在像素基的情况下，基函数\InsertInlineEq{\phi_n}是其第n个像素的值等于1而所有其他像素都为零的图像。如果我们希望从远小于图像中总像素数n的测量数中恢复图像\InsertInlineEq{g=\sum_n\beta_n\phi_n}，我们当然不能使用像素基作为测量基。由于\RefFig{6.8}所示的图像在像素基上是稀疏的，再次选择像素基进行测量将意味着大多数标量积\InsertInlineEq{(A_j,\phi_n)}将为零，并且恢复问题将是无意义的。另一方面，如果我们选择一个傅里叶基来测量\InsertInlineEq{A}中的矢量，那么大多数标量积都可能存在，这使得使用适当设计的算法来恢复稀疏图像成为可能。因此，要遵循的一个重要准则是，要恢复的图像通常不能在\InsertInlineEq{\phi_n}基和测量基中都是稀疏的。这两个基集的这个性质用所谓的限制等距性质来更正式地表示。
\subsubsection{压缩成像原理的系统级含义}
解决这种“不完全数据”反问题的可能性对于未来成像系统的设计具有重要意义。压缩成像等概念背后的哲学对以下几类问题很重要：
\InsertItem{\item \textbf{成像系统突破传统的感知极限。}我们现在有了一个新的框架来重新审视我们对成像系统性能指标的概念，如分辨率、对噪声的敏感度等，并进化出新的成像概念，在这些方面可能优于传统成像。
\item \textbf{更简单/更精简的成像系统。}高质量的成像性能和更少的测量量意味着简化了成像系统设计，并相应降低了医疗，安全，教育等领域的成像技术成本，对社会产生了深远的影响}

\section{随机过程}
在本章中，我们将介绍随机过程理论中的几个重要概念，这些概念将在以后讨论光的相干特性时有用。 当物理现象由于大量未知（几乎随机）因素而发生时，实验结果的观察和预测只能以统计学的方式完成。 对于大多数光学/光子学中光的产生，由于传播和检测本质上不是确定性的，因此对随机过程的研究至关重要。

  \end{sloppypar}
\end{document}