%vscode_config。
%导言区，用于配置格式
%指定编译器是xelatex
%!TEX program=xelatex 
\documentclass[10pt, UTF8]{ctexart}%指明文档是中文
\usepackage{hyperref}%导入包
\usepackage{graphicx}%导入图片包
\usepackage[b5paper]{geometry}%定义大小
%改变字体背景颜色需要color和framed宏包
\usepackage{framed}
\usepackage{color}% 导入颜色
%\usepackage{underscore}%取消下划线识别 这个包去掉，要不文件名不能有下划线
\usepackage[normalem]{ulem} 
\usepackage{amsmath}%加入对齐包
\definecolor{shadecolor}{rgb}{0.92,0.92,0.92}
%公式、图片随章节改变
\usepackage{amsmath}
\numberwithin{equation}{section}
\numberwithin{figure}{section}
%自定义函数
\def\CodingInline#1{\colorbox{shadecolor}{\color{black}#1}}%内联代码
\newcommand {\InsertPic}[3]{\begin{figure}[htbp]\centering \includegraphics[width=1\textwidth]{D:/学习文档/傅里叶光学/翻译/tu/Fourier-Optics-and-Computational-Khare_img_#1.jpg}\caption{#3}  \label{#2}\end{figure}}%插入图片
\def\CodingBlock#1{\begin{shaded} \noindent#1 \end{shaded}}
\def\Emphasize#1{\textcolor[rgb]{1,0,0}{#1}}
\newcommand{\InsertEqution}[2]{\begin{equation}
  \label{#1}
   #2
 \end{equation}}
\newcommand{\RefEq}[1]{Eq.\ref{#1}}
\newcommand{\InsertInlineEq}[1]{$#1$}
\newcommand{\RefFig}[1]{图 \ref{#1}}
\newcommand{\InsertItem}[1]{\begin{enumerate} #1 \end{enumerate}}

%正文区
%begin end 用于指定环境
\begin{document}
  \begin{sloppypar}
     %配置开头
     \title{傅里叶光学和计算成像翻译}
     \author{Dr. Li}
     \date{2020年5月3日}
     \maketitle

     %摘要
    \begin{abstract}
        用于翻译Fourier Optics and Computatinal Imaging, 目前自用
        \begin{figure}[htbp]%h当前位置，t顶部，b底部，p浮动
            \centering
            \includegraphics[width=1\textwidth]{D:/MyCoding/ElectronicComics/comics4.png}
            % \caption{LOGO}
        \end{figure} 
    \end{abstract}
    \newpage

    
    \section{采样定理}
    我们经常听到或谈论今天在我们周围看到的数字革命。由于我们每天使用的数字设备，我们的生活在一代人的时间内发生了巨大变化。为了使像手机这样的小工具成为可能，必须开发和整合许多技术。但是为什么我们经常建模为连续函数的信号的数字表示之所以可能的核心思想在于采样定理。在讨论这个之前，我要指出，通过电磁手段进行的通信在20世纪初很实用。那时，量化传达某些特定信息所需的资源的问题变得很重要。克劳德·香农（Claude Shannon）为开发形式主义以量化信息以进行交流而功劳。他关于该主题的标题为“通信的数学理论”（Bell Systems Tech. Journal
    1948）的文章是经典著作。正如我之前已经讨论过的，在成像或相关现象中我们感兴趣的信息被编码在波中将信息从对象传送到我们系统上。尽管我们的大多数波动现象模型都是连续的，但任何测量所需的采样都是在离散点进行的。采样多少是合适的？从直觉上看，抽取的样本越多越好。 但是，也很明显，如果您想对语音信号进行采样，那么当感兴趣的最高音频频率最多为几kHz时，以1MHz或1GHz的速率进行采样可能会太多。 我们可以以某种方式将这种直觉形式化吗？我们可以确定所需采样率的界限吗？ 我们将在本章中研究这个重要的基本问题。 采样思想在计算成像系统中起着重要作用。图像的离散点通常被表示为图像的像素点。
    
   \subsection{泊松求和方程}
   我们将通过对泊松求和方程的傅里叶变换得出采样定理。有了泊松方程我们就不难获得采样定理。只是在交流信息中这个结果才有意义。我们首先考虑一个信号$g(x)$和对应的傅里叶变换
   \InsertEqution{3.1}{G\left(f_{x}\right)=\int_{-\infty}^{\infty} d x g(x) \exp \left(-i 2 \pi f_{x} x\right)}
  首先我们使用$G(f_x)$构造一个周期为$\Delta$的周期函数，然后表示为一个傅里叶序列\InsertEqution{3.2}{\sum_{n=-\infty}^{\infty} G\left(f_{x}+n \Delta\right)=\sum_{k=-\infty}^{\infty} g_{k} \exp \left(-i 2 \pi k f_{x} / \Delta\right)}
  利用周期函数的傅里叶逆变换可获得\RefEq{3.2}系数$g_k$。\InsertEqution{3.3}{\begin{aligned}
g_{k} &=\frac{1}{\Delta} \int_{-\Delta / 2}^{\Delta / 2} d f_{x} \sum_{n=-\infty} G\left(f_{x}+n \Delta\right) \exp \left(i 2 \pi k f_{x} / \Delta\right) \\
&=\frac{1}{\Delta} \sum_{n=-\infty}^{\infty} \int_{\left(n-\frac{1}{2}\right) \Delta}^{\left(n+\frac{1}{2}\right) \Delta} d u G(u) \exp (i 2 \pi k u / \Delta-i 2 \pi n k)
\end{aligned}}
因为\InsertInlineEq{n,k}是整数，我们可以知道\InsertInlineEq{\exp (-i 2 \pi n k)=1}。此外因为\InsertInlineEq{n:-\infty\rightarrow\infty},有效的覆盖了整个\InsertInlineEq{u},因此周期项可以忽略，\RefEq{3.3}可以写成\InsertEqution{3.4}{\begin{aligned}
  g_{k} &=\frac{1}{\Delta} \int_{-\infty}^{\infty} d u G(u) \exp (i 2 \pi k u / \Delta) \\
  &=\frac{1}{\Delta} g\left(\frac{k}{\Delta}\right)
  \end{aligned}}
从以上结果可以知道，通过对\InsertInlineEq{G(f_x)}添加规则的移位形成的周期函数，相应的傅立叶级数系数​​只是点\InsertInlineEq{x=k/\Delta}处函数\InsertInlineEq{g(x)}的周期采样,\InsertInlineEq{k}为整数。
\subsection{特殊情况下的采样定理}
为了建立采样定理，我们将定义带限信号。如果信号\InsertInlineEq{g(x)}的傅里叶变换在\InsertInlineEq{f_{x}:(-B, B)}外消失，我们就称这个信号是带限信号。现在我们将考虑当信号\InsertInlineEq{g(x)}受到上述带宽限制且\InsertInlineEq{\Delta = 2B}时的泊松求和公式的特例。 现在，傅立叶变换的移位版本不重叠，我们可以在方程\RefEq{3.2}两边相乘一个矩形函数来滤除\InsertInlineEq{n=0}项:\InsertEqution{3.5}{G\left(f_{x}\right)=\frac{1}{2 B} \sum_{k=-\infty}^{\infty} g\left(\frac{k}{2 B}\right) \exp \left(-i 2 \pi k \frac{f_{x}}{2 B}\right) \operatorname{rect}\left(\frac{f_{x}}{2 B}\right)}
对齐进行逆傅里叶变换可以得到\InsertEqution{3.6}{\begin{aligned}
  g(x) &=\frac{1}{2 B} \sum_{k=-\infty}^{\infty} g\left(\frac{k}{2 B}\right) \int_{-\infty}^{\infty} d f_{x} \exp \left[i 2 \pi f_{x}\left(x-\frac{k}{2 B}\right)\right] \operatorname{rect}\left(\frac{f_{x}}{2 B}\right) \\
  &=\sum_{k=-\infty}^{\infty} g\left(\frac{k}{2 B}\right) \operatorname{sinc}\left[2 B\left(x-\frac{k}{2 B}\right)\right]
\end{aligned}}
它告诉我们，以\InsertInlineEq{1/2B}分开的离散点处的带限信号\InsertInlineEq{g(x)}的样本包含与连续信号相同的信息。 如果我们知道这些离散的样本值，则可以\CodingInline{通过对样本进行正弦插值}来重建连续信号。这个采样率被称为奈奎斯特率。
\subsection{采样公式的其他说明}
关于采样定理，需要注意的比较重要的一点是，移动的sinc函数集合构成了一组正交完备基。这与其他集合不同（如Hermite-Gauss函数），这里是统一个函数不同的移动版本是正交的。这种不寻常的基可以追溯到小波等不寻常基的起源。\\
这个集合的正交性的证明如下：\InsertEqution{3.7}{\begin{aligned}
  &\int_{-\infty}^{\infty} d x \operatorname{sinc}(2 B x-m) \operatorname{sinc}(2 B x-n) \\
  &\quad=\left.\mathcal{F}^{-1}\left\{\frac{1}{(2 B)^{2}} \operatorname{rect}^{2}\left(\frac{f_{x}}{2 B}\right)\right\}\right|_{x=\frac{m-n}{2 B}} \\
  &\quad=\frac{1}{2 B} \operatorname{sinc}(m-n) \\
  &\quad=\frac{1}{2 B} \delta_{m, n}
  \end{aligned}
  }
  在计算中，我们使用的卷积定理。带限信号\InsertInlineEq{g(\frac{m}{2B})}可以看成sinc基下的相关系数，即\InsertEqution{3.8}{g\left(\frac{m}{2 B}\right)=\frac{1}{2 B} \int_{-\infty}^{\infty} d x g(x) \operatorname{sinc}(2 B x-m)}
sinc基集合的完备性可以很简单的证明，观察到：\InsertEqution{3.9}{\sum_{n=-\infty}^{\infty} \operatorname{sinc}(2 B x-m) \operatorname{sinc}\left(2 B x^{\prime}-m\right)=\operatorname{sinc}\left[2 B\left(x-x^{\prime}\right)\right]}
使用采样定理应用于sinc函数本身。对于每一个带限信号\InsertInlineEq{g(x)},带宽\InsertInlineEq{f_{x}:(-B, B)},我们有\InsertEqution{3.10}{\begin{aligned}
  \int_{-\infty}^{\infty} d x^{\prime} g\left(x^{\prime}\right) \operatorname{sinc}\left[2 B\left(x-x^{\prime}\right)\right] &=\mathcal{F}^{-1}\left[G\left(f_{x}\right) \frac{1}{2 B} \operatorname{rect}\left(\frac{f_{x}}{2 B}\right)\right] \\
  &=\frac{1}{2 B} g(x)
  \end{aligned}}
  如果现在将完整性关系用于\InsertInlineEq{sinc[2B(x-x')]}和\RefEq{3.8}的关系，就得出了采样定理。因此，sinc基可以表示每个带限函数，可以将表达式\InsertInlineEq{sinc[2B(x-x')]}视为\InsertInlineEq{\delta(x-x')}的带限版本。
  \subsection{对载频信号的采样}
  有时通过陈述僵化的规则来简单地解释香农采样定理具有误导性，即正弦信号每个正弦周期需要两个采样。 因为如果知道我们采样的是正弦曲线，那么仅应从知道其频率，幅度和初始相位的角度就可以确定波形。 实际上，在通信中遇到的一类重要信号，窄带光场表示和光学干涉成像等形式的情况下，也会出现类似情况。这种情况可以表示为：\InsertEqution{3.11}{g(x)=a(x) \exp \left(i 2 \pi f_{0} x\right)+a^{*}(x) \exp \left(-i 2 \pi f_{0} x\right)}。这里\InsertInlineEq{a(x)}是信号的复振幅包络，\InsertInlineEq{f_0}是载频。此类信号在大多数情况下，包络\InsertInlineEq{a(x)}的有效带宽\InsertInlineEq{2B}是远小于载频\InsertInlineEq{f_0}的，典型的载频信号的傅里叶幅度如图\InsertPic{13}{F3.1}{\InsertInlineEq{\left|G(f_x)\right|}的傅里叶频谱强度}。因此包络的有效带宽和载频的比值\InsertEqution{3.12}{\frac{f_{0}}{2 B} \geq \frac{f_{0}}{2 B_{0}}=N+\frac{1}{2}},对于一些给定的整数\InsertInlineEq{N}(可能是最大值对于确定的\InsertInlineEq{f_0,B}),\footnote[1]{这里意思是说对于给定的\InsertInlineEq{B},总可以找到一个稍微大一些的值\InsertInlineEq{B_0},使其满足\InsertInlineEq{f_0}是\InsertInlineEq{N+\frac{1}{2}}倍的\InsertInlineEq{B_0},这样\InsertInlineEq{N}可以使用sinc函数的频移来表示，剩下来的\InsertInlineEq{\frac{1}{2}}就是一个2倍于\InsertInlineEq{2B_0}的信号，可以用\InsertInlineEq{1/4B_0}的间隔去采样。}
  这样信号\InsertInlineEq{g(x)}就可以用\InsertInlineEq{1/(4B_0)}的采样间隔来获得采样定理下的信号形式：\InsertEqution{3.13}{g(x)=\sum_{k=-\infty}^{\infty} g\left(\frac{k}{4 B_{0}}\right) \operatorname{sinc}\left[2 B_{0}\left(x-\frac{k}{4 B_{0}}\right)\right] \cos \left[2 \pi f_{0}\left(x-\frac{k}{4 B_{0}}\right)\right]}
  也可以使用低通采样定理类似的论据得出上述结果，并且有时将其称为带通采样定理。 此结果的中心思想是有效利用以下事实：即使采样间隔比\InsertInlineEq{1/2(f_0+B)}大得多，傅里叶空间中的空白区域也不会导致混叠。上式中的余弦项可以表示为两个指数项的总和，而解调后的包络\InsertInlineEq{a(x)}可以表示为一个采样序列：\InsertEqution{3.14}{a(x)=\sum_{k=-\infty}^{\infty} g\left(\frac{k}{4 B_{0}}\right) \operatorname{sinc}\left[2 B_{0}\left(x-\frac{k}{4 B_{0}}\right)\right] \exp \left(-2 \pi f_{0} \frac{k}{4 B_{0}}\right)}
  因此，采样率与复杂包络中的波动相当，而不是最大信号带宽。在以上讨论中暗含了对载波频率\InsertInlineEq{f_0}的了解。正如我们将在下一节中讨论的那样，此结果对于量化信号的自由度非常重要。
  \subsection{信号的自由度：空间带宽积}
  假设我们有一个长度为2L的信号要存储或传输给其他人，需要多少空间？大多数实际信号或图像都是有限范围的，并且严格意义上来讲不能有限长的信号不能同时是带限的。它的傅里叶变换原则上必须在整个频率轴上扩展。因此，带宽的概念需要仔细定义。对于长度在\InsertInlineEq{x:(-L,L)}的信号\InsertInlineEq{g(x)},我们在频率段\InsertInlineEq{f_x:(-B,B)}定义能量集中比\InsertInlineEq{\alpha}为\InsertEqution{3.15}{\alpha=\frac{\int_{-B}^{B} d f_{x}\left|G\left(f_{x}\right)\right|^{2}}{\int_{-\infty}^{\infty} d f_{x}\left|G\left(f_{x}\right)\right|^{2}}}。
对于带宽的实用的定义为在频率段\InsertInlineEq{fx:(-B,B)}内，能量集中比接近于实际应用要求的1（比如0.999）。需要多少个信号样本才能以相当准确的方式表示它？ 答案是\InsertInlineEq{2B\times2L}。\InsertInlineEq{N=4BL}的乘积称为空间带宽积，他表示信号的自由度。对于2D信号或者图像这个数是\InsertInlineEq{N^2},即表示图形所需的像素数。

信号和系统的空间带宽积是两个不同的概念。假设我们的对象是放置在玻片内的生物组织样本，需要在显微镜下观察。活细胞是一个非常复杂的对象，感兴趣的细节可以在分子或者纳米尺度上对应于空间频率的数量级是\InsertInlineEq{10^{9}m^{-1}},则对于一个\InsertInlineEq{1mm\times1mm}物体，空间带宽积为为\InsertInlineEq{(10^-3)^2\times(10^9)^2=10^12}。而观测细胞的系统可以具有小的多的空间带宽积。用于可见光的显微镜的分辨率可能只有\InsertInlineEq{1\mu m}，因此该显微系统的空间带宽积是\InsertInlineEq{(10^-3)^2\times(10^6)^2=10^6}。因此，如果要将CCD相机作为探测器放置在显微镜的后端，则\InsertInlineEq{1000\times1000}像素的传感器芯片就足够了。如果我们在弱光条件下运行，则噪声会使来自每个像素的信号有些不可靠。我们可能需要对传感器芯片进行binning，以便对一个\InsertInlineEq{2\times2}像素块进行平均。因此，生成的图像是\InsertInlineEq{500\times500}像素,减少了可以从系统设置程序中检索到的信息。因此，空间带宽乘积既取决于系统参数，又取决于信噪比。\footnote[1]{这里不太正确，应该是空间带宽积还是这么多，但是信号的置信度下降了，导致可以直接获得的真实信息的量减少了，这种是可以通过其他方法恢复的。}
\subsection{Slepian(椭球形)函数}
我们在\RefEq{3.15}中定义了能量集中率，以便对带宽做出实际定义。\InsertInlineEq{\alpha}的最大值问题由香农在1950年提出。Slepian，Pollak和Landau在Bell System Tech的一系列论文中对该问题进行了全面分析。 为了纪念D.Slepianz这类函数被称为Slepianz函数。我们会讨论这些函数一些有趣的性质，然后建立起和采样定理的关联。当我们讨论诸如超分辨或者成像系统的信息承载呢能力是，Slepian函数将会比较有用。

对于一个在\InsertInlineEq{x:(-L,L)}上的函数\InsertInlineEq{g(x)},我们可以利用傅里叶变换将能量集中率\InsertInlineEq{\alpha}表示为：\InsertEqution{3.16}{\alpha=\frac{\int_{-B}^{B} d f_{x}\left|G\left(f_{x}\right)\right|^{2}}{\int_{-\infty}^{\infty} d f_{x}\left|G\left(f_{x}\right)\right|^{2}}}
我们观察到上述\InsertInlineEq{\alpha}的展开是sinc核的Rayleigh-Ritz系数，则\InsertInlineEq{\alpha}的最大值可以由\InsertInlineEq{(2B\lambda_0)}获得,\InsertInlineEq{\lambda_0}是以下特征方程的特征值。\InsertEqution{3.17}{\lambda \phi(x)=\int_{-L}^{L} d x^{\prime} \operatorname{sinc}\left[2 B\left(x-x^{\prime}\right)\right] \phi\left(x^{\prime}\right)}通常prolate基函数会按照相应特征值的大小降序排列。对于给定的\InsertInlineEq{L,B}, 最大的\InsertInlineEq{N}个特征方程可以在能量集中的意义上认为是最佳的基。Slepian和他的同事在早期工作中认识到，sinc-kernel的本征函数是在方程\InsertInlineEq{\chi(c)}的离散正值的条件下，椭球面微分方程的角部分的解：\InsertEqution{3.18}{\left(L^{2}-x^{2}\right) \frac{d^{2} \phi}{d x^{2}}-2 x \frac{d \phi}{d x}+\left(\chi-\frac{c^{2} x^{2}}{L^{2}}\right)=0}。参数\InsertInlineEq{c=2\pi LB}被称为香农数，与空间带宽积有关。关于Slepian函数的大多数文献都是基于微分方程\RefEq{3.18}的解及其根据\InsertInlineEq{c}值的渐近解来研究其性质的。我们将基于采样定理采用不同的方法。基于微分方程解的讨论在某种程度上是临时的，与诸如采样定理固有相关的空间带宽积之类的思想没有简单的联系。

我们注意到\RefEq{3.17}中的特征值是第二类其次Fredholm积分方程，该方程的核是厄米对称且平方可积的。此外这个核还是正定的：\InsertEqution{3.19}{
  \int_{-L}^{L} \int_{-L}^{L} d x d x^{\prime} \operatorname{sinc}\left[2 B\left(x-x^{\prime}\right)\right] g(x) g^{*}\left(x^{\prime}\right) \\
  \quad=\frac{1}{2 B} \int_{-B}^{B} d f_{x}\left|G\left(f_{x}\right)\right|^{2} \\
  \quad \geq 0
  }
  对于任意平方可积函数\InsertInlineEq{g(x)}。当\InsertInlineEq{g(x)}等于零时，\RefEq{3.19}的等号成立，因此，sinc核的特征值为正。我们将首先表明，sinc核的本征函数满足采样定理，因此受到带宽限制。我们已经注意到，sinc内核本身是有带宽限制的，因此具有以下采样扩展：
  \InsertEqution{3.20}{\operatorname{sinc}\left[2 B\left(x-x^{\prime}\right)\right]=\sum_{m=-\infty}^{\infty} \operatorname{sinc}(2 B x-m) \operatorname{sinc}\left(2 B x^{\prime}-m\right)}。对\RefEq{3.17}使用sinc核展开可以得到：\InsertEqution{3.21}{\begin{aligned}
    \lambda \phi(x) &=\int_{-L}^{L} d x^{\prime} \sum_{m=-\infty}^{\infty} \operatorname{sinc}(2 B x-m) \operatorname{sinc}\left(2 B x^{\prime}-m\right) \phi\left(x^{\prime}\right) \\
    &=\sum_{m=-\infty}^{\infty}\operatorname{sinc}(2 B x-m)\times(\int_{-L}^{L} d x^{\prime} \operatorname{sinc}\left(2 B x^{\prime}-m\right) \phi\left(x^{\prime}\right))
    \\&=\lambda \sum_{m=-\infty}^{\infty} \phi\left(\frac{m}{2 B}\right) \operatorname{sinc}(2 B x-m)
    \end{aligned}}
  所以\RefEq{3.17}可以写成\InsertEqution{3.22}{\begin{aligned}
    \lambda \phi\left(\frac{m}{2 B}\right) &=\int_{-L}^{L} d x^{\prime} \operatorname{sinc}\left(2 B x^{\prime}-m\right) \phi\left(x^{\prime}\right) \\
    &=\int_{-L}^{L} d x^{\prime} \operatorname{sinc}\left(2 B x^{\prime}-m\right) \sum_{n=-\infty}^{\infty} \phi\left(\frac{n}{2 B}\right) \operatorname{sinc}\left(2 B x^{\prime}-n\right) \\
    &=\sum_{n=-\infty}^{\infty} A_{m n}^{(0)} \phi\left(\frac{n}{2 B}\right)
    \end{aligned}}
  其中矩阵\InsertInlineEq{A^{(0)}}的元素可以定义为：\InsertEqution{3.23}{A_{m n}^{(0)}=\int_{-L}^{L} d x^{\prime} \operatorname{sinc}\left(2 B x^{\prime}-m\right) \operatorname{sinc}\left(2 B x^{\prime}-n\right)}
可以发现，sinc核的连续特征值问题因此等效于矩阵\InsertInlineEq{A^{(0)}}的离散特征值问题。\footnote{\InsertInlineEq{\lambda\phi\left(\frac{n}{2B}\right)=A^{(0)}_{mn}\phi(\frac{n}{2B})}}
连续和离散问题共享相同的特征值 此外，矩阵\InsertInlineEq{A^{(0)}}的特征向量与连续椭球状函数的Nyquist样本相同。 因此，可以通过对离散特征向量进行正弦插值来获得连续函数。
\subsubsection{\InsertInlineEq{A^{(0)}}的性质}
为了简洁起见，我们将矩阵\InsertInlineEq{A^{(0)}}的离散特征向量表示为
\InsertEqution{?1}{u_{n}=\left[\ldots \phi_{n}\left(\frac{m}{2 B}\right) \ldots\right]^{T}},符号T是行向量的转置。\InsertInlineEq{A^{(0)}}是实对称的所以他的特征值和特征向量是实数。我们将连续函数\InsertInlineEq{\phi_n(x)}归一化为\InsertInlineEq{x:(-\infty,\infty)},可以写成:\InsertEqution{3.24}{\int_{-\infty}^{\infty} d x \phi_{n}^{2}(x)=1 = \frac{1}{2 B} \sum_{m=-\infty}^{\infty} \phi_{n}^{2}\left(\frac{m}{2 B}\right)}。\RefEq{3.24}来自以下事实，\InsertInlineEq{\phi_n(x)}根据\RefEq{3.21}扩展采样，进一步使用了sinc函数的正交性\RefEq{3.7}。\InsertInlineEq{A^{(0)}}是关于元素\InsertInlineEq{A^{(0)}_{00}}是对称的。众所周知，此类矩阵的特征向量具有确定的奇偶性-它们是偶数或奇数。因此，通过离散特征向量的正插值获得的连续特征函数也具有一定的奇偶性。

矩阵\InsertInlineEq{A^{(0)}}可以被分解为\InsertEqution{3.25}{A^{(0)}=U A_{d}^{(0)} U^{T}}。其中\InsertInlineEq{A^{(0)_d}}是对角矩阵，特征值\InsertInlineEq{\lambda_n}分布在对角线上，矩阵\InsertInlineEq{U}具有特征向量\InsertInlineEq{u_n}。此外特征向量是正交的:\InsertEqution{3.26}{U^{T} U=2 B \hat{\mathbf{1}}=U U^{T}}利用这些恒等式\InsertInlineEq{\phi_n(\frac{m}{2B})}可以显式地获得以下关系：正交性\InsertEqution{3.27}{\sum_{m=-\infty}^{\infty} \phi_{n}\left(\frac{m}{2 B}\right) \phi_{l}\left(\frac{m}{2 B}\right)=2 B \delta_{n l}}完备性\footnote[1]{完备性表示可以用这个基表示整个空间}\InsertEqution{3.28}{\sum_{n=0}^{\infty} \phi_{n}\left(\frac{m}{2 B}\right) \phi_{n}\left(\frac{k}{2 B}\right)=2 B \delta_{m k}}
矩阵\InsertInlineEq{A^{(0)}}的结构非常有趣由于矩阵元素被定义为移位正弦函数乘积上的定积分，因此只有大约\InsertInlineEq{(2B)(2L)}个矩阵元素沿着以矩阵元素为\InsertInlineEq{A^{(0)}_{00}}中心的矩阵对角线是有效的。这解释了sinc核的一个众所周知的性质，即问题的最高特征值只有大约\InsertInlineEq{4BL}是显著的。这对于使用prolate函数的信号表示有着有趣的含义。\InsertPic{14}{F3.2}{\InsertInlineEq{L=1,B=5/\pi}时，使用基于采样定理的方法计算的前8个prolate函数}\InsertPic{15}{F3.3}{\InsertInlineEq{L=1,B=5/\pi}时，sinc核函数的前10个特征值}
在\RefFig{F3.2}和\RefFig{F3.3}中我们展示了使用基于采样定理的方法分别计算prolate函数及其对应的特征值\footnote{求矩阵\InsertInlineEq{A_{mn}^{(0)}的特征值和特征向量，每个特征向量插值后就是prolate函数}}。使用以元素\InsertInlineEq{A^{(0)}_{00}}为中心的矩阵\InsertInlineEq{A^{(0)}}的\InsertInlineEq{101\times101}近似值，并根据\RefEq{3.23}中的定义使用标准数值积分方法计算矩阵元素。然后，对由此获得的离散特征向量进行内插，以获得连续的特征函数。 总的来说，我们观察到第n个长函数在间隔\InsertInlineEq{x:(-L,L)}中有n个过0点。对于\InsertInlineEq{n>4BL}阶的函数，这似乎是违反直觉的，其中零交叉点的数量超过了空间带宽积，尽管相应的长函数仍在无限间隔内被带宽限制。与空间带宽乘积相比，这样的函数在有限的时间间隔内具有更多的零交叉，实际上被称为“超振荡”。我们进一步注意到，当索引n超过\InsertInlineEq{4BL}时，相应的函数函数中的大多数能量都集中在间隔\InsertInlineEq{x:(-L,L)}之外。

我们将陈述prolate函数\footnote{\InsertInlineEq{\phi_n(x)}}的一些有趣特性，这些特性可以很容易地从\RefEq{3.27}和\RefEq{3.28}中的离散正交性和完整性关系中得出。

1.对偶正交性:曲线函数在\InsertInlineEq{-\infty,\infty}以及正交域\InsertInlineEq{x:(-L,L)}用于定义\InsertEqution{3.29}{\int_{-\infty}^{\infty} d x \phi_{n}(x) \phi_{m}(x)=\delta_{m, n}}
\InsertEqution{3.30}{\int_{-L}^{L}d x \phi_{n}(x) | \phi_{m}(x)=\left(2 B \lambda_{n}\right) \delta_{m, n}}
如果使用\InsertInlineEq{\phi_n(x)}和\InsertInlineEq{\phi_m(x)}的采样扩展，然后按照\RefEq{3.27}，则第一个恒等式很容易证明。\RefEq{3.30}的有限区间的第二正交性可以证明如下：\InsertEqution{3.31}{\begin{aligned}
  &\int_{-L}^{L} d x \phi_{n}(x) \phi_{m}(x) \\
  &=\sum\limits_{k=-\infty}^{\infty} f_{n}\left(\frac{k}{2 B}\right) \int_{-L}^{L} d x \operatorname{sinc}(2 B x-k) \phi_{m}(x) \\
  &=\lambda_{m} \sum\limits_{k=-\infty}^{\infty} \phi_{n}\left(\frac{k}{2 B}\right) \phi_{m}\left(\frac{k}{2 B}\right) \\
 & =2 B \lambda_{m} \delta_{m, n}
  \end{aligned}}

  2.完备性：Prolate函数在函数带宽限制为\InsertInlineEq{f_x:(-B,B)}的情况下在\InsertInlineEq{-\infty,\infty}上具有正交基础，而在\InsertInlineEq{x:(-L,L)}中的平方可积函数具有完整的正交基础。

  在考虑带限外推之类的问题时，我们将使用正交性和完整性属性。通常，在本书的整个讨论中，当讨论成像系统的信息传输功能时，我们将有各种场合引用Prolate函数。我们注意到，基于采样定理的曲线函数的方法通常同样适用于与带限核相关的特征值问题，并且在一般情况下，可以证明与Prolate椭球体类似的一些有趣的数学关系。
  \subsection{带限函数外推}
  Prolate椭球面函数的双重正交性和完整性属性可用于外推截短区域内已知的带限函数。假设在有限范围\InsertInlineEq{x:(-L,L)}内已知一个限制在频带\InsertInlineEq{f_x:(-B,B)}上的函数\InsertInlineEq{g(x)}，则可以使用如下设置的椭球函数扩展它：\InsertEqution{3.32}{g(x)=\sum_{n} a_{n} \phi_{n}(x)},其中可以使用区域\InsertInlineEq{x:(-L,L)}上的Prolate函数的正交性确定系数：\InsertEqution{3.33}{a_{n}=\frac{1}{2 B \lambda_{n}} \int_{-L}^{L} d x g(x) \phi_{n}(x)}
  另外，原则上可以通过使用相同的系数\InsertInlineEq{a_n}将函数扩展到范围\InsertInlineEq{x:(-L,L)}之外。 但是，确定函数超出范围\InsertInlineEq{x:(-L,L)}的可能性实际上取决于我们对\InsertInlineEq{g(x)}的有限范围知识的准确性。例如，如果\InsertInlineEq{g(x)}的值是通过一些实验测量确定的，则它们将包含一些噪声，这些噪声会转换为系数\InsertInlineEq{a_n}的噪声。在\RefEq{3.33}中，系数\InsertInlineEq{a_n}的获得涉及除以相应的特征值\InsertInlineEq{\lambda_n}。正如我们在上面已经看到的，当索引\InsertInlineEq{n>>4 B L}和相应的函数函数的大部分能量集中在\InsertInlineEq{x:(-L,L)}范围之外时，特征值通常很小。因此，尽管这样的高阶曲线函数能够在已知函数\InsertInlineEq{g(x)}的有限范围内重建信号，但将它们包含在级数表示中会涉及将相应系数\InsertInlineEq{a_n}除以非常小的特征值。 由于系数\InsertInlineEq{a_n}是有噪声的，因此用小数除法会放大噪声，从而使序列表示毫无意义。避免噪声放大的一种简单方法是将序列表示截断为有限数量的项，然后有效地构成超出\InsertInlineEq{(-L,L)}的有限范围的外推。外推的问题严重的依赖于对\InsertInlineEq{g(x)}测量的SNR。 通常可以使用Slepian函数根据外推法来制定数字超分辨率成像技术。

  在结束本章讨论时，我们注意到通过sinc集合或Slepian函数基础进行的采样彼此等效。诸如小波之类的相关领域中重要发展的起源可以追溯到本章所涵盖的内容。
\section{快速傅立叶变换介绍}
\subsection{定义}
本书将不时遇到傅立叶变换，对于学生和从业人员来说，重要的是要对数值例程或函数具有基本的操作性理解，这些数字例程或函数可用于对离散采样的信号和图像实施傅立叶变换。 本章决不讨论离散傅立叶变换和快速傅立叶变换算法的详细信息，对于这些算法，已有很好的文献资料。此处的目的是提供足够的信息，以便在将标准计算工具或库用于FFT操作时，用户可以理解结果。 沿途还指出了有关使用2D傅里叶变换函数模拟光学成像系统的一些重要方面。

通过对第三章中所讨论的采样思想的介绍，我们现在可以用采样来在空间带宽积\InsertInlineEq{N\approx4BL}表示长度超过\InsertInlineEq{2L}有效带宽超过\InsertInlineEq{2B}的信号\InsertInlineEq{g(0/2B),g(1/2B),...,g((N-1)/2B)}。离散的傅里叶变换可以被定义为：\InsertEqution{4.1}{G\left(\frac{m}{2 L}\right)=\sum_{n=0}^{N-1} g\left(\frac{n}{2 B}\right) \exp (-i 2 \pi m n / N)}
相应的傅里叶逆变换可以被定义为\InsertEqution{4.2}{g\left(\frac{n}{2 B}\right)=\frac{1}{N} \sum_{m=0}^{N-1} G\left(\frac{m}{2 L}\right) \exp (i 2 \pi m n / N)}
我们注意到，当信号仅通过离散样本集定义在\InsertInlineEq{x:(-L,L)}上时，上述离散傅里叶变换操作近似于傅里叶变换的连续积分形式。空域样本的周期为\InsertInlineEq{1/(2B)}，而频域周期为\InsertInlineEq{1/(2L)}。在大多数情况下，通常会省略\InsertInlineEq{2B,2L},但在这里我们保留这个参数。可以观察到正向和反向DFT是线性变换，可以以矩阵形式编写。 例如使用符号\InsertEqution{4.3}{\omega=\exp (i 2 \pi / N)},对于N个以1为开始的变换\RefEq{4.1}可以写成\InsertEqution{4.4}{\mathbf{G}=\mathbf{F} \mathbf{g}}或者\InsertEqution{4.5}{\left(\begin{array}{c}
  G\left(\frac{0}{2 L}\right) \\
  G\left(\frac{1}{2 L}\right) \\
  \cdot \\
  \cdot \\
  G\left(\frac{N-1}{2 L}\right)
  \end{array}\right)=\left(\begin{array}{cccc}
  1 & 1 & \cdots & 1 \\
  1 & \omega^{-1} & \cdots & \omega^{N-1} \\
  \cdot & \cdot & \cdots & \cdot \\
  \cdot & \cdot & \cdots & \cdot \\
  & \cdot & \cdots & \cdot \\
  1 & \omega^{-(N-1)} & \cdots & \omega^{-(N-1)^{2}}
  \end{array}\right)\left(\begin{array}{c}
  g\left(\frac{0}{2 \beta}\right) \\
  g\left(\frac{1}{2 B}\right) \\
  \cdot \\
  \cdot \\
  g\left(\frac{N-1}{2 B}\right)
  \end{array}\right)}
我们可以注意到\InsertInlineEq{\omega}满足\InsertEqution{4.6}{\omega^{(N-m)}=\omega^{-m}}
结果，频率\InsertInlineEq{0/(2L),1/(2L),...,(N-1))/(2L)}形成离散傅立叶变换\InsertInlineEq{G}的自变量可以被重新排序为正和负频率。用于定义正和负频率的典型约定如下：
\InsertItem{\item \InsertInlineEq{N}为基数：\InsertInlineEq{\nu = 0/(2L)}是零频率或dc项，\InsertInlineEq{\nu=1/(2L)}到\InsertInlineEq{\nu=(N/2)/2L}被视为正频率，而\InsertInlineEq{\nu=(N/2)+1/(2L)}到\InsertInlineEq{\nu=(N-1)/2L}被视为负频率。
\item \InsertInlineEq{N}为偶数，\InsertInlineEq{\nu = 0/(2L)}是零频率或dc项，\InsertInlineEq{\nu=1/(2L)}到\InsertInlineEq{\nu=((N+1)/2)/2L}被视为正频率，而\InsertInlineEq{\nu=((N+3)/2)/2L}到\InsertInlineEq{\nu=(N-1)/2L}被视为负频率。}
定义了负频率之后，根据\RefEq{4.6}的\InsertInlineEq{\omega}的性质，\InsertInlineEq{\nu=(N-1)/2L}等效于\InsertInlineEq{\nu=-1/2L}，并依此类推。
\subsection{使用2D快速傅立叶变换解决光学问题}
在不考虑变换矩阵\InsertInlineEq{F}的任何属性的情况下，我们注意到计算离散傅里叶变换将需要\InsertInlineEq{N^2}乘法运算。Cooley和Tukey在1965年发布了一种利用F矩阵的对称性并将乘法运算的数量减少到\InsertInlineEq{N\log N}数量级的算法时，取得了长足的进步。
  用于计算DFT的相应算法称为快速傅立叶变换(FFT)。FFT算法的思想可以追溯到高斯（Gauss）的出版物，但是在Cooley和Tukey的工作之后，这一意义得到了重视。 FFT现在已成为基准，在计算复杂度方面经常将其与其他算法进行比较。 我们将不提供FFT理论背后的详细讨论，而只会向读者介绍使用FFT算法的操作方面，而FFT算法现在可以在广泛使用的计算工具（例如MATLAB，SciLab，NumPy等）中使用。

  正如我们将在本书的后续章节中看到的那样，傅立叶变换自然发生在光波传播，光学信息处理方法等的研究中。在光学和其他成像系统进行建模，分析和合成的数字处理方法中广泛的用到FFT算法。在这些应用中，重要的是要了解任何标准二维FFT工具提供的结果的含义以及正确使用功能，以便从物理学的角度来看这些结果有意义。

  我们将提供2D rect函数的2D傅里叶变换的计算示例。\InsertPic{16}{F4.1}{2维矩形函数的2维傅里叶变换。(a)rect函数；傅里叶变换后的振幅是（b）相位为（c）。相位函数中的暗像素和亮像素分别对应于0和\InsertInlineEq{\pi}的相位值。}如\RefFig{F4.1}所示，在大小为\InsertInlineEq{255\times255}的2D网格上定义了大小等于11个像素的rect函数。

  图\RefFig{F4.1}（b）和（c）分别显示了通过简单应用上述标准计算工具中的函数\InsertInlineEq{fft2}获得的图像的幅度和相位。 结果看起来不像预期的2D Sinc函数。我们注意到，sinc函数的中央波瓣现在分布在所得图像的拐角附近。这是因为标准FFT工具的零频分量在合成矢量的开头而不是其中心处。一个常见的解决方法是在结果上使用fftshift功能，该功能可使零频率回到图像中心。\InsertPic{17}{F4.2}{在2D矩形函数对象上应用序列\InsertInlineEq{fftshift(fft2(...))}的结果}
  在rect函数上应用序列\InsertInlineEq{fftshift(fft2(...))}分别得到如\RefFig{F4.2}（a）和（b）所示的幅度和相位这里的幅度部分看起来很合理，但是相位仍然不是期望的正弦函数。这个结果可以理解如下,将傅立叶变换计算为：\InsertEqution{4.7}{\int_{-\infty}^{\infty} \int_{-\infty}^{\infty} d x d y \operatorname{rect}\left(\frac{x}{a}, \frac{y}{a}\right) \exp \left[-i 2 \pi\left(f_{x} x+f_{y} y\right)\right]}应用于rect函数中心的正确相位值对应于零（因为\InsertInlineEq{x=0,y=0}）。但是，根据标准FFT约定，该点的相位应用于图像的一角。 因此，必须使用标准的\InsertInlineEq{ifftshift}函数对要进行傅里叶变换的初始图像进行适当的修改，该函数通过交换象限将图像的中心移到角落。因此，要在大多数编程平台中2D FFT的适当顺序对于从物理角度来看有意义的结果（例如在描述衍射现象）中有意义，应该使用的计算顺序是\Emphasize{\InsertInlineEq{fftshift(fft2(ifftshift(...)))}}。
  \InsertPic{18}{F4.3}{在2D矩形函数对象上应用序列\InsertInlineEq{fftshift(fft2(ifftshift(...)))}的结果}
  用此序列计算出的rect函数的2D FFT的幅度和相位如图\RefFig{F4.3}(a),(b)所示。现在，振幅和相位都是光学中的常规要求。因此，合适的逆傅里叶变换可以是\Emphasize{\InsertInlineEq{fftshift(ifft2(ifftshift(...)))}}。

  函数\InsertInlineEq{fftshift}和\InsertInlineEq{ifftshift}对于偶数维矢量通常是相同的，但对于奇数维矢量则相差一个像素。而无论所涉及的矢量的维数是偶数还是奇数，上述正向和反向FFT的两个序列都可以按照光学的标准惯例用于产生正确的相位行为。
  我们已经为研究人员常用的计算工具提供了FFT例程的操作介绍。 此处通过示例说明了有关\InsertInlineEq{fftshift}和\InsertInlineEq{ifftshift}函数以及\InsertInlineEq{fft}例程的用法的细微之处。 这些主题已在此处进行了讨论，因为当初学者或学生开始研究与光学成像和衍射现象有关的基于FFT的仿真时，它们似乎是常见的错误来源。

\section{线性系统的形式和成像逆问题介绍}

  \end{sloppypar}
\end{document}